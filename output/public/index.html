<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>

    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title> Mudox &middot; Mudox </title>

    
    <link rel="stylesheet" href="/lib/normalize/normalize.css">
    <link rel="stylesheet" href="/lib/mudox_hyde.css">

    
    
    <link rel="stylesheet" href="/lib/fonts/fonts.css">

    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/lib/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/lib/favicon.ico">

    
    <link href="http://mudox.github.io/index.xml/" rel="alternate" type="application/rss+xml" title="Mudox" />

    
    <script src="/lib/jquery/jquery.min.js"></script>

    
    
    
    <link rel="stylesheet" href="/lib/highlight/styles/tomorrow.css">
    <script src="/lib/highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script src="/lib/tagcanvas/jquery.tagcanvas.min.js"></script>

    
    <script src="/lib/particles/particles.js"></script>

    
    
    

    
    <link rel="stylesheet" href="/lib/animate/animate.min.css">

  </head>

<body class="theme-base-red">

  <div class="sidebar">

  
  <div id="particles-js"> </div>

  
  <div id="sidebar-front-content" class="container">

    <nav id=sidebar-menu>
      
      <li class="top-menu-item">
        <a href="http://mudox.github.io/note/">NOTES</a>
      </li>
      <li class="top-menu-item">
        <a href="http://mudox.github.io/memo/">MEMOS</a>
      </li>
      <li class="top-menu-item">
        <a href="http://mudox.github.io/project/">PROJECTS</a>
      </li>
      <li class="top-menu-item">
        <a href="http://mudox.github.io/post/">POSTS</a>
      </li>
    </nav>

    <nav id="cloud-container">
      <canvas id="cloud-canvas" width="300" height="300" style="width: 100%;">
        
        <a href="/languages">languages</a> 
        <a href="/languages/bash">bash</a> 
        <a href="/languages/c">c</a> 
        <a href="/languages/css">css</a> 
        <a href="/languages/english">english</a> 
        <a href="/languages/go">go</a> 
        <a href="/languages/html">html</a> 
        <a href="/languages/javascript">javascript</a> 
        <a href="/languages/lua">lua</a> 
        <a href="/languages/objc">objc</a> 
        <a href="/languages/oc">oc</a> 
        <a href="/languages/swift">swift</a> 
        <a href="/languages/viml">viml</a>  
        <a href="/platforms">platforms</a> 
        <a href="/platforms/arch">arch</a> 
        <a href="/platforms/ios">ios</a> 
        <a href="/platforms/linux">linux</a> 
        <a href="/platforms/macos">macos</a> 
        <a href="/platforms/web">web</a> 
        <a href="/platforms/win">win</a>  
        <a href="/series">series</a> 
        <a href="/series/error">error</a> 
        <a href="/series/setup">setup</a>  
        <a href="/tags">tags</a> 
        <a href="/tags/appdev">appdev</a> 
        <a href="/tags/awesome">awesome</a> 
        <a href="/tags/bash">bash</a> 
        <a href="/tags/cocoa">cocoa</a> 
        <a href="/tags/concurrency">concurrency</a> 
        <a href="/tags/dev">dev</a> 
        <a href="/tags/git">git</a> 
        <a href="/tags/libraries">libraries</a> 
        <a href="/tags/me">me</a> 
        <a href="/tags/setup">setup</a> 
        <a href="/tags/shell">shell</a> 
        <a href="/tags/system">system</a> 
        <a href="/tags/tool">tool</a> 
        <a href="/tags/translation">translation</a> 
        <a href="/tags/unicode">unicode</a> 
        <a href="/tags/vim">vim</a> 
        <a href="/tags/vocabulary">vocabulary</a> 
        <a href="/tags/zsh">zsh</a>  
      </canvas>
    </nav>

    <div class="sidebar-about sidebar-sticky">
      <div id="logo"><a href="/" id="Mudox" class="animated bounceInLeft">Mudox</a>
      </div>
      <p class="lead">
        My site powered by <a href="http://gohugo.io">Hugo</a> with a theme customized from <a href="https://github.com/spf13/hyde.git">hyde</a>.
      </p>
      <p>&copy; 2015. All rights reserved. </p>
    </div>

  </div>

</div>


  <div class="content container">
    <div class="posts">

      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/ios_notes_media_frameworks/">
            iOS NOTES - Media Frameworks
          </a>
        </h1>

        <span class="post-date">Wed, Apr 29, 2015</span>

        

<h1 id="toc_0">iOS Media Frameworks Stack</h1>

<p><img src="../../../note/media_stack.svg" alt="iOS media frameworks Stack" />
</p>

<h1 id="toc_1">The Trunk Relation Graph</h1>

<p><img src="../../../note/media_trunk_graph.svg" alt="iOS media framework trunk relation graph" />
</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/translation_swift_dynamic_dispath/">
            Swift 官博文章翻译 - 通过减少动态调度来拉升程序性能
          </a>
        </h1>

        <span class="post-date">Wed, Apr 29, 2015</span>

        

<p>原文链接：<a href="https://developer.apple.com/swift/blog/?id=27">Increasing Performance by Reducing Dynamic Dispatch </a></p>

<p>译者：Mudox</p>

<p>和其他很多语言一样，Swift 运行程序员改写从父类集成来的方法和属性。这意味着程序得在运行时也只用在运行时才能判断所引用的具体的方法或属性，并间接的调用或访问他们。这一技术名为“动态分配 dynamic dispatch”，通过为每次间接调用或访问增加常亮时间的开销来换取语言表达能力的提升。对于性能苛刻的代码，这类开销是不可取的。本文将展示三种通过消除此类动态性来拉升程序性能的方法：<code>final</code>，<code>private</code> 以及整模块优化策略。</p>

<p>请看如下代码:</p>

<pre><code class="language-swift">class ParticleModel {
  var point = ( 0.0, 0.0 )
  var velocity = 100.0

  func updatePoint(newPoint: (Double, Double), newVelocity: Double) {
    point = newPoint
    velocity = newVelocity
  }

  func update(newP: (Double, Double), newV: Double) {
    updatePoint(newP, newVelocity: newV)
  }
}

var p = ParticleModel()
for i in stride(from: 0.0, through: 360, by: 1.0) {
  p.update((i * sin(i), i), newV:i*1000)
}
</code></pre>

<p>编译器将会生成如下动态分派代码：</p>

<ol>
<li>调用 <code>update</code> 于 <code>p</code>。</li>
<li>调用  <code>updatePoint</code> 于 <code>p</code>。</li>
<li>访问 <code>p</code> 的 <code>point</code> 元祖属性。</li>
<li>访问 <code>p</code> 的 <code>velocity</code> 属性。</li>
</ol>

<p>这也许并不是你想要的。动态调度在这里之所以必要，是因为 <code>ParticleModel</code> 的子类可能重写其属性。</p>

<p>在 Swift 中，动态调度通过从函数表中搜索正确的函数并间接调用他们来实现。这显然比直接调用来的慢。此外，间接调用还会阻碍很多编译器对代码的优化，这又进一步增加了程序运行的开销。在性能关键的代码中，Swift 提供了一些技术来关闭某些不必要的动态调度以拉升程序性能。</p>

<h2 id="toc_0">当你确定某个声明不会被覆盖时，使用 <code>final</code> 关键字</h2>

<p>关键字 <code>final</code> 可以修饰类，方法或者属性的声明，它指示编译器这些声明不会被后续代码覆盖。这样编译器就能放心的在这些对象上关闭动态调度特性（不生成动态调度的代码）。比如下面的类属性 <code>point</code>，<code>velocity</code> 和函数 <code>updatePoint()</code> 将被直接访问和调用。而方法 <code>update()</code> 仍然需要通过动态调度来间接的被调用，它也因此能被子类们覆盖。</p>

<pre><code class="language-swift">class ParticleModel {
  final var point = ( x: 0.0, y: 0.0 )
  final var velocity = 100.0

  final func updatePoint(newPoint: (Double, Double), newVelocity: Double) {
    point = newPoint
    velocity = newVelocity
  }

  func update(newP: (Double, Double), newV: Double) {
    updatePoint(newP, newVelocity: newV)
  }
}
</code></pre>

<p>It is possible to mark an entire class as final by attaching the attribute to the class itself. This forbids subclassing the class, implying that all functions and properties of the class are final as well.</p>

<p>您可以用 <code>final</code> 修饰整个类的声明，这样做将直接禁止对该类的子类化，因此对其所有属性和方法的访问将都是直接的。</p>

<pre><code class="language-swift">final class ParticleModel {
  var point = ( x: 0.0, y: 0.0 )
  var velocity = 100.0
  // ...
}
</code></pre>

<h2 id="toc_1">为 <code>private</code> 声明自动推导 <code>final</code> 语义</h2>

<p>被 <code>private</code> 修饰的声明其可见性会限制在声明它的文件里。如果在该文件里，没有发现对该声明的覆盖，编译器就不会为该声明生成动态调度代码，而是直接的访问他们。</p>

<p>假设在该文件中，没有对类 <code>ParticleModel</code> 的覆盖，那么编译器就会关闭对其所有 <code>private</code> 成员的动态调度，取而代之以更加快速的直接访问。
Assuming there is no class overriding ParticleModel in the current file, the compiler can replace all dynamically dispatched calls to private declarations with direct calls.</p>

<pre><code class="language-swift">class ParticleModel {
  private var point = ( x: 0.0, y: 0.0 )
  private var velocity = 100.0

  private func updatePoint(newPoint: (Double, Double), newVelocity: Double) {
    point = newPoint
    velocity = newVelocity
  }

  func update(newP: (Double, Double), newV: Double) {
    updatePoint(newP, newVelocity: newV)
  }
}
</code></pre>

<p>上述代码中，<code>point</code>，<code>velocity</code> 和 <code>updatePoint()</code> 将被直接访问和调用。由于 <code>update()</code> 没有被 <code>private</code> 修饰，它仍然需要被动态调度。</p>

<p>和 <code>final</code> 一样，<code>private</code> 也可以被用来直接修饰整个类声明，这相当于在该类的所有成员声明面前加了 <code>private</code> 关键字。</p>

<pre><code class="language-swift">private class ParticleModel {
  var point = ( x: 0.0, y: 0.0 )
  var velocity = 100.0
  // ...
}
</code></pre>

<h1 id="toc_2">通过模块级的优化来对 <code>internal</code> 声明推导出 <code>final</code> 语义</h1>

<p>在 Swift 中，所有声明的可见性默认为 <code>internal</code>，也就是说他们只能在定义他们的模块内可见。编译器通常会单独的编译模块内的每个文件，因此它在变异某一个源文件时，无法判断在同意模块内的其他源文件里是否对该源文件内定义的 <code>internal</code> 声明的覆盖。但是如果我们启用了编译器的 <code>Whole Module Optimization</code> 模块级优选项，所以的文件将在一次编译过程中全部被编译。这样编译器就能在整个模块范围类分析是否某个 <code>internal</code> 声明被覆盖了，从而推导出 <code>final</code> 语义以关闭动态调度特性。</p>

<p>让我们回到最开始的代码，这回我们额外添加一些 <code>public</code> 关键到 <code>ParticleModel</code> 的声明中。</p>

<pre><code class="language-swift">public class ParticleModel {
  var point = ( x: 0.0, y: 0.0 )
  var velocity = 100.0

  func updatePoint(newPoint: (Double, Double), newVelocity: Double) {
    point = newPoint
    velocity = newVelocity
  }

  public func update(newP: (Double, Double), newV: Double) {
    updatePoint(newP, newVelocity: newV)
  }
}

var p = ParticleModel()
for i in stride(from: 0.0, through: times, by: 1.0) {
  p.update((i * sin(i), i), newV:i*1000)
}
</code></pre>

<p>当开启了模块级优化选项的编译器处理以上代码时，它能够推导出 <code>point</code>, <code>velocity</code> 和 <code>updatePoint()</code> 方法可以关闭动态调度特性。与此相反，由于 <code>update()</code> 被 <code>public</code> 修饰，其可见性延伸到了模块之外，所以编译器无法断定它具有 <code>final</code> 语义。</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/translation_swift_memory_safety/">
            Swift 官博文章翻译 - 内存安全：确保值在使用前先初始化
          </a>
        </h1>

        <span class="post-date">Tue, Apr 28, 2015</span>

        

<p>原文链接：<a href="https://developer.apple.com/swift/blog/?id=28">Memory Safety: Ensuring Values are Initialized Before Use</a></p>

<p>译者：Mudox</p>

<p>我们设计 Swift 这门语言时的一个重要的发力方向就是改进编程模型的内存安全性。内存安全有很多方面，本文将由浅入深，先从一个简单的问题开始：如果确保值在使用前被初始化。</p>

<h1 id="toc_0">Swift 的方式</h1>

<p>如果每当一个变量第一次被访问时，该变量都有一个有效的初始值，那么该变量就被认为是“安全”的。不同的语言采用了不同的方式来提供这种安全性。比如 C 语言，它将责任完全交给程序员——这种方法强大，但是也很有难度。C++ 和 Objective-C 通过施加一些强制性的模式来改善此类情况，还有一些语言则（比较极端的）要求变量在定义时就必须初始化。</p>

<p>Swift 采用的主要技术是通过其先进的编译器来对代码的数据流进行分析。由编译器在编译时确保变量在使用前正确初始化，这是是一种名为 <a href="http://en.wikipedia.org/wiki/Definite_assignment_analysis">明确初始化——Definitive Initialization</a> 的策略。还有很多语言比如 Java，C# 都采用了类似的策略，而 Swift 则是的该策略的一个扩展版本应用于更大范围的变量上面。</p>

<h1 id="toc_1">本地变量的明确初始化</h1>

<p>在 Swift 中有很多场景都用到了该策略，其中最简单的场景就是用于本地变量。相较于“隐式的默认值初始化 implicit default initialization”，明确初始化初始化提供了更大的灵活性，因为它运行你写出如下的代码：</p>

<pre><code class="language-swift">var myInstance : MyClass  // Uninitialized non-nullable class reference

if x &gt; 42 {
  myInstance = MyClass(intValue: 13)
} else {
  myInstance = MyClass(floatValue: 92.3)
}

// Okay because myInstance is initialized on all paths
myInstance.printIt()
</code></pre>

<p>这里编译器能分析出 <code>if</code> 语言的两个分支里都对变量 <code>myInstance</code> 做了初始化，因此它确信后面的 <code>printIt()</code> 方法不会被调用于未初始化的内存上面。</p>

<p>明确初始化策非常强大，但是它只有在代码可靠并可预测的情况下才能发挥作用。当你的代码的控制流逻辑比较复杂时，它就可能出意外。比如如下代码：</p>

<pre><code class="language-swift">var myInstance : MyClass

if x &gt; 10 {
  myInstance = MyClass(intValue: 13)
}
// ...
if x &gt; 42 {
  myInstance.printIt()
}
</code></pre>

<p>上述代码运行时，编译器会发出警告：“变量 <code>myInstance</code> 在使用前未初始化”。这是因为编译器并不能分析出上下两个 if 语句的条件之间的内在逻辑关系。尽管我们能让编译器照顾到此类个别特殊情况，但是它还是不可能覆盖所有的特殊情况（这其实就是所谓的“<a href="http://en.wikipedia.org/wiki/Halting_problem">停机问题 halting problem</a>”），因此我们决定保持编译规则简单可预测。</p>

<p>Swift 使初始化一个变量变得极其简单。事实上用 Swift 在声明时给出初始化值 <code>var x = 0</code> 比声明一个未初始化的变量 <code>var x: Int</code> 所得到的代码更简短。Swift 提倡在任何可能的时候给声明的变量一个明确的初始化值。还有更加强大的方法就是通过调用 <code>init()</code> 方法来初始化一个变量。想要了解更加详细的信息，请参阅 Swfit Programming Language 的“<a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Initialization.html">初始化 Initialization</a>” 一章。</p>

<h1 id="toc_2">其他的方式</h1>

<p>除了明确初始化之外，Swift 在特定情况下也会采用一些其他的策略。您很可能已经在其他语言中碰到过这些策略，因此我们将在本文中简短的介绍下他们。他们都用各自不足之处，所以 Swift 并没有将他们当做主要策略来使用。</p>

<p><strong>将安全性交给程序</strong>：鉴于 C 的普及程度，我们有必要了解下简单的将安全性责任交给程序员这种做法的利与弊。在 C 中使用未经初始化的值会导致<a href="http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html">不确定的行为 undefined behavior</a>，经常表现为程序的运行时异常。C 语言依赖程序永远都不要犯错误。我们设计 Swift 语言的初衷之一就是让它从本质上就是安全的，所以这一策略果断被我们排除于绝大部分情况之外。但是，Swift 还是提供了诸如 <code>UnsafePointer</code> 这样的 API，以允许你再绝对必要的情况下启用这种策略。</p>

<p><strong>隐式的默认值初始化</strong>：可以让编译器隐式的初始化一个值，以确保其安全性。比如，在 Objective-C 中，给实例的成员变量设置一个初始的“零值”，或者像 C++ 那样给类提供默认的初始化器。我们曾深入探索过这一方法，但做种决定不广泛使用它。因为：</p>

<ul>
<li><p>它对与那些没有合理初始化值的类型不起作用，比如 protocol 对象并没有 <code>init()</code> 方法可以调用，已经在 Swift 非常普遍的不可为空的类引用。</p></li>

<li><p>就算是对于基本类型，比如对于一个 integer 变量，0 常常在上下文中是一个不合理的值。这也是为什么在 Swift 中给变量赋初始化值如此容易的原因之一。此外，这让代码对于后续的维护者更加的清晰明了。</p></li>
</ul>

<p>注意：对于 <code>Optional</code> 和 <code>ImplicitlyUnwrappedOptional</code> 这类可以为空的值，把他们默认初始化为空 <code>nil</code> 是理所当然的。因此在 Swift 中所有飞空值都会被自动初始化为空值。</p>

<p><strong>强制在定义时初始化</strong>：强制要求程序在定义变量是给与其初始值，意味着 <code>var x: Int</code> 将是非法的，因为它没有提供初始值给编译器。尽管该策略通用于函数式编程语言中, 但是我们认为这一要求国语严格而没有必要，也妨碍了程序员对自然模式的表达。</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/ios_notes_amap/">
            iOS NOTES - AMAP API DEPICTED
          </a>
        </h1>

        <span class="post-date">Tue, Apr 28, 2015</span>

        

<p>AMap (高德地图) APIs depicted in several graphs I draw.</p>

<h1 id="toc_0">AMap Searching API</h1>

<p><img src="../../../note/amap_searching_graph.svg" alt="AMap Searching API Graph" />
</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/ios_notes_lbs/">
            iOS NOTES - LOCATION BASED SERVIES
          </a>
        </h1>

        <span class="post-date">Fri, Apr 17, 2015</span>

        

<p>Quick steps to use iOS&rsquo;s LBS technology.</p>

<h1 id="toc_0">Core Location</h1>

<p>iOS devices integrates various hardware components, such as:</p>

<ul>
<li><p>GPS (Global Positioning System) for positioning</p></li>

<li><p>Hardware compass for heading monitoring.</p></li>

<li><p>WiFi for positioning.</p></li>

<li><p>Cellular network for cell-tower triangulation.</p></li>

<li><p>Blue tooth for iBeacon ranging.</p></li>

<li><p>some data sensors for improve positioning accuracy under some circumstances.</p></li>
</ul>

<p>to provides users with following LBS abilities as much as possible:</p>

<ol>
<li><p>Location Updates</p>

<ol>
<li><p>Standard location updates</p></li>

<li><p>Significant location updates</p></li>
</ol></li>

<li><p>Heading monitoring</p></li>

<li><p>Region monitoring</p></li>

<li><p>iBeacon ranging</p></li>

<li><p>Visit events</p></li>
</ol>

<p>The <code>CLLocationManager</code> acts just like an <code>NSNotificationCenter</code> (but it is not
a singleton) between the LBS hardwares and your App, you use it to request the
authorization for LBS functionalities you are planning to use afterwords, and
adjusts the relevant parameters of them before starting their notification
updating loops.</p>

<p>After you call one of its&rsquo; <code>start***</code> or <code>request***</code> methods to emit requests
for one of the 5 LBS abilities mentioned above, the <code>CLLocationManager</code>
activate relevant hardware components, when the data is available it notifies
you asynchronously by calling one of the its&rsquo; delegate&rsquo;s methods.</p>

<p><img src="../../../note/core_location_map.svg" alt="Core Location Map" />
</p>

<h2 id="toc_1">Work flow of using LBS abilities.</h2>

<ol>
<li><p>Project setup</p>

<ol>
<li><p>Enable <em>Background Location Updates Background Mode</em> capability.</p></li>

<li><p>Add <em>NSLocationAlwaysUsageDescriptions</em> or
<em>NSLocationWhenInUseUsageDescription</em> key to info.plist.</p></li>
</ol></li>

<li><p>Configuring <code>CLLocationManager</code></p>

<ol>
<li><p>Creating a <code>CllocationManager</code> instance and hold a strong reference to it.</p></li>

<li><p>Specify location manager&rsquo;s delegate, usually be a view controller.</p></li>

<li><p>Check &amp; request authorization status.</p></li>

<li><p>Configures the relevant properties for the LBS functionality you are about
to use.</p></li>

<li><p>Before starting each LBS updating functions, there are also corresponding
APIs you can invoke to check the services availability.</p></li>

<li><p>Call <code>start**</code> methods to start the various LBS notification loops.</p></li>
</ol>

<pre><code class="language-swift">// declare as some long-standing reference outside of function body.
let locationManager = CLLocationManager()
--------------------
// within functions ( be it in viewDidLoad() )
// designate delegate
locationManager.delegate = self
// request for authorization
locationManager.requestAlwaysAuthorization()
// configure updating related settings
locationManager.activityType = .AutomotiveNavigation
locationManager.desiredAccuracy = kCLLocationAccuracyBestForNavigation
locationManager.distanceFilter = 10
// finally check device &amp; service availability before starting notification loop.
if CLLocationManager.locationServicesEnabled() {
  locationManager.startUpdatingLocation()
} else {
  let alert = UIAlertController(
    title: &quot;Service Not Available&quot;,
    message: &quot;The location is not available or has been shut down.&quot;,
    preferredStyle: .Alert)
  presentViewController(alert, animated: true, completion: nil)
}
</code></pre></li>

<li><p>Implement <code>CLLocationManagerDelegate</code> methods in you designated delegate
object to:</p>

<ul>
<li><p>handle received location data updates.</p></li>

<li><p>handle LBS failures.</p></li>

<li><p>handle authorization status changes.</p></li>

<li><p>&hellip;</p></li>
</ul></li>
</ol>

<h1 id="toc_2">MapKit</h1>

<p>In general, MapKit:</p>

<ol>
<li><p>shows map in one of three map types:</p>

<ul>
<li><p>Standard</p></li>

<li><p>Satellite</p></li>

<li><p>Hybrid</p></li>
</ul></li>

<li><p>along with many built-in elements:</p>

<ul>
<li><p>compass</p></li>

<li><p>POIs (points of interest)</p></li>
</ul></li>

<li><p>and provides developer with two kinds of customizable presentation
facilities:</p>

<ul>
<li><p>annotations</p></li>

<li><p>overlays</p></li>
</ul></li>
</ol>

<p>As of managing annotations, MapKit adopts the same design pattern as that is
heavily used by <code>UITableView</code> &ndash; decoupling data model from presentation tools
through <strong>reuse pool</strong>. Hence, there comes separate class hierarchies for
storing annotation (overlay) data, and presenting them respectively.</p>

<ul>
<li><p>data object</p>

<ul>
<li><p>all objects that conforms to <code>MKAnnotation</code> protocol, are responsible for
storing data for annotations, such as location, textual info, etc.</p></li>

<li><p>all objects that conforms to <code>MKOverlay</code> protocol, are responsible for
storing data for overlays, such as location, etc.</p></li>
</ul></li>

<li><p>presentation tools</p>

<ul>
<li><p>instances that inherit from <code>MKAnnotationView</code> can be <strong>reused</strong> to display a data objects.</p></li>

<li><p>instances that inherit from <code>MKOverlayRenderer</code> can be used to display a overlay objects.</p></li>
</ul></li>
</ul>

<p><img src="../../../note/map_kit_map.svg" alt="MapKit map" />
</p>

<h2 id="toc_3">Customize annotation view</h2>

<p>A annotation view usually consist of 2 parts:</p>

<ol>
<li>The view view.</li>
</ol>

<p>Set its&rsquo; <code>image</code> property to change its&rsquo; appearance.</p>

<ol>
<li>The callout view, which is popped up when the pin view is selected.</li>
</ol>

<p>The built-in callout view is not exposed for customization, so we should disable the <code>canShowCallout</code> property</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/swift_notes_closure/">
            SWIFT NOTES - CLOSURE
          </a>
        </h1>

        <span class="post-date">Tue, Apr 14, 2015</span>

        

<p>Thanks to the host of technologies provided by the Swift
compiler, the closure comes with a bunch of syntactic
sugars that could sweet you to diabetes.</p>

<p>The full syntax of a closure:</p>

<pre><code class="language-swift">{
  (parameters) -&gt; retrunType in
  ... statements ...
}
</code></pre>

<p>Here is an example that uses the array&rsquo;s method <code>sorted</code> to sort an array of
word.</p>

<pre><code class="language-swift">var words = [ &quot;Dolor&quot;, &quot;eum&quot;, &quot;id&quot;, &quot;suscipit&quot;, &quot;necessitatibus&quot;, &quot;quod&quot;, &quot;hic&quot;, &quot;dignissimos&quot; ]

let sortedWords = words.sorted({
  (lhs: String, rhs: String) -&gt; Bool in
  return lhs &lt; rhs
})
</code></pre>

<p>As the sugars introduced in, we will cut the lines above into an incredibly one
line of code.</p>

<h1 id="toc_0">Sugar #0 &ndash; trailing closure</h1>

<p>Often, closure parameter is placed last in parameter list. Swift thus provides
<strong>trailing closure</strong>, which means your can write the inline closure just
outside the parameter list, following the closing <code>)</code>.</p>

<p>Furthermore, if the closure is the only parameter, then the parenthesis can be
omitted.</p>

<pre><code class="language-swift">// trailing closure
let sortedWords = words.sorted/*()*/ {
  (lhs: String, rhs: String) -&gt; Bool in
  return lhs &lt; rhs
}
</code></pre>

<h1 id="toc_1">Sugar #1 &ndash; return type inference</h1>

<p><strong>return type</strong> can be inferred by swift compiler.</p>

<pre><code class="language-swift">// omit return type
let sortedWords = words.sorted {
  (lhs: String, rhs: String) /*-&gt; Bool*/ in
  return lhs &lt; rhs
}
</code></pre>

<h1 id="toc_2">Sugar #2 &ndash; parameter type inference</h1>

<p><strong>parameter types</strong> can be inferred by swift compiler as well.</p>

<pre><code class="language-swift">// omit parameter types
let sortedWords = words.sorted {
  (lhs/*: String*/, rhs/*: String*/) /*-&gt; Bool*/ in
  return lhs &lt; rhs
}
</code></pre>

<h1 id="toc_3">Sugar #3 &ndash; parenthesis-less</h1>

<p>Since no type annotation is needed, the <strong>parenthesis</strong> can be omitted.</p>

<pre><code class="language-swift">// omit parenthesis
let sortedWords = words.sorted {
  /*(*/lhs/*: String*/, rhs/*: String)*/ /*-&gt; Bool*/ in
  return lhs &lt; rhs
}
</code></pre>

<h1 id="toc_4">Sugar #4 &ndash; return statement inference</h1>

<p>If the closure has one statement, then the <strong>return</strong> statement can also be
inferred.</p>

<pre><code class="language-swift">// omit 'return'
let sortedWords = words.sorted {
  /*(*/lhs/*: String*/, rhs/*: String)*/ /*-&gt; Bool*/ in
  /*return*/ lhs &lt; rhs
}

//then we got:
let sortedWords = words.sorted { lhs, rhs in lhs &lt; rhs }
</code></pre>

<h1 id="toc_5">Sugar #5 &ndash; shorthand parameter name</h1>

<p>Swift provides <strong>shorthand parameter names</strong>: $0 for the 1st parameter, $1 for
the 2nd parameter, and so on. And as an side effect, the whole <code>(parameters) -&gt;
returType in</code> statement can be completely omitted</p>

<pre><code class="language-swift">// use shorthand parameters, omit the whole 'in' statement
let sortedWords = words.sorted {
  /*(lhs: String, rhs: String) -&gt; Bool in*/
  /*return*/ $0 &lt; $1
}

// then we got:
let sortedWords = words.sorted { $0 &lt; $1 }
</code></pre>

<h1 id="toc_6">Sugar #6 &ndash; operator as a closure</h1>

<p>In swift, <strong>operator</strong> is a function, which in turn is a <strong>special closure</strong>, so&hellip;</p>

<pre><code class="language-swift">// comes operator!
let sortedWords = words.sorted(&lt;)
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/unicode_concepts_defined/">
            UNICODE CONCEPTS DEFINED
          </a>
        </h1>

        <span class="post-date">Mon, Apr 13, 2015</span>

        <p>Collect several Unicode concepts encountered when I learn Swift&rsquo;s String type.</p>

<ul>
<li><p>UCS</p>

<p>Universal Coded Character Set (通用字符集)</p>

<blockquote>
<p>The Universal Coded Character Set (UCS), defined by the International
Standard ISO/IEC 10646, Information technology — Universal Coded
Character Set (UCS) (plus amendments to that standard), is a standard set
of characters upon which many character encodings are based. The UCS
contains nearly one hundred thousand abstract characters, each identified
by an unambiguous name and an integer number called its code point.</p>
</blockquote></li>

<li><p>Unicode</p>

<p>统一码，万国码, 单一码</p>

<blockquote>
<p>Unicode is a computing industry standard for the consistent encoding,
representation, and handling of text expressed in most of the world&rsquo;s
writing systems. Developed in conjunction with the Universal Character
Set standard and published as The Unicode Standard, the latest version of
Unicode contains a repertoire of more than 110,000 characters covering
100 scripts and multiple symbol sets.</p>
</blockquote>

<p>As for its&rsquo; code space layout:</p>

<blockquote>
<p>Unicode comprises 1,114,112 code points in the range 0x0 to 0x10FFFF.
The Unicode code space is divided into 17 planes (the basic multilingual
plane, and 16 supplementary planes), each with 65,536 (= 216) code
points. Thus the total size of the Unicode code space is 17 × 65,536 =
1,114,112.</p>
</blockquote></li>

<li><p>UTF</p>

<p>UCS/Unicode Transformation Format (通用字符集转换格式, Unicode 转换格式)</p></li>

<li><p>UTF-8</p>

<blockquote>
<p>UTF-8 (U from Universal Character Set + Transformation Format—8-bit[1])
is a character encoding capable of encoding all possible characters
(called code points) in Unicode. The encoding is variable-length and uses
8-bit code units. It was designed for backward compatibility with ASCII
and to avoid the complications of endianness and byte order marks in
UTF-16 and UTF-32.</p>
</blockquote></li>

<li><p>code point (code position)</p>

<blockquote>
<p>In character encoding terminology, a code point or code position is any
of the numerical values that make up the code space.</p>
</blockquote></li>

<li><p>Unicode scalar</p>

<blockquote>
<p>Behind the scenes, Swift’s native String type is built from Unicode
scalar values. A Unicode scalar is a unique 21-bit number for a character
or modifier.</p>
</blockquote>

<p>The distinction between Unicode scalar &amp; Unicode code point could be
clarified as follows:</p>

<blockquote>
<p>A Unicode scalar is any Unicode code point in the range U+0000 to U+D7FF
inclusive or U+E000 to U+10FFFF inclusive. Unicode scalars do not include
the Unicode surrogate pair code points, which are the code points in the
range U+D800 to U+DFFF inclusive.</p>
</blockquote>

<p>It is a Swift language specific notion, or more actually, a Swift defined
internal type for storing string charactor&rsquo;s Unicode points that Swift
choose to support. Behind the scene, it&rsquo;s a 21bit long numeric type, but
not all number in the range can reponds to a valid Unicode point.</p>

<p>So mathematically, the Unicode points universal set is a discrete subset of
integer set [0, 0x10FFFF]. The Swift Unicode scalar universal set is, in
turn, a discrete subset of Unicode code point universal set (with all
<em>surroagte pair</em> code points stripped).</p></li>

<li><p>code unit</p>

<blockquote>
<p>A code unit is a bit sequence used to encode each character of a
repertoire. Encodings associate their meaning with either a single code
unit value or a sequence of code units as one value.</p>
</blockquote></li>

<li><p>extended grapheme cluster</p>

<blockquote>
<p>Every instance of Swift’s Character type represents a single extended
grapheme cluster. An extended grapheme cluster is a sequence of one or
more Unicode scalars that (when combined) produce a single human-readable
character.</p>
</blockquote></li>
</ul>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/swift_notes_functions/">
            SWIFT NOTES - FUNCTIONS
          </a>
        </h1>

        <span class="post-date">Mon, Apr 13, 2015</span>

        

<p>Excerpts from the &ldquo;Functions&rdquo; section of the official docuemnt &ldquo;The Swift
Programming Language&rdquo;</p>

<h1 id="toc_0">Function Parameters</h1>

<h2 id="toc_1">Parameter names</h2>

<p>A parameter name can have a <strong>internal name</strong> and an <strong>external name</strong> declared
in the form of: <code>external_name internal_name: type</code>.</p>

<pre><code class="language-swift">func join(String string: leftString, toString rightString) -&gt; String {
  return leftString + rightString
}

println(join(String: &quot;Hello&quot;, toString: &quot; World!&quot;))
</code></pre>

<p>Use <code>#</code> to use the same name for both names: <code>#name: type</code></p>

<pre><code class="language-swift">func join(#aString: leftString, #toString) -&gt; String {
  return aString + toString
}

println(join(aString: &quot;Hello&quot;, toString: &quot; World!&quot;))
</code></pre>

<p>Use <code>_</code> to suppress external name: <code>_ internal_name: type</code></p>

<pre><code class="language-swift">func join(_ aString: leftString, _ toString) -&gt; String {
  return aString + toString
}

println(join(&quot;Hello&quot;, &quot; World!&quot;))
</code></pre>

<h2 id="toc_2">Parameters with default value</h2>

<p>Default parameter values of the <code>[external_name /_/#]internal_name: type =
default_value</code> should be placed at end of the parameter list.</p>

<p>The compiler will synthesize a external name by reusing the internal name for
parameters with default value, if their external name is not explicitly
specified in the parameter list. (You can use <code>_</code> to suppress this behavior,
which is not recommended.)</p>

<pre><code class="language-swift">func Foo(arg1: String, arg2: Int = 30, _ arg3: Bool, #arg4: Double) {
  ...
}

Foo(&quot;text&quot;, arg2: 1, true, arg4: 4.0)
</code></pre>

<h2 id="toc_3">Variadic parameters</h2>

<p>Declare variadic parameter in form <code>name: type...</code>, which, in the function
body, is of type <code>[type]</code>.</p>

<p>Only one variadic parameter is allowed in a parameter list, and it should be
placed after all other normal parameters or parameters with default value.</p>

<h2 id="toc_4">Variable parameters</h2>

<p>Prefix parameter names with keyword <code>var</code> to make them modifiable inside the
function body.</p>

<p>It is just another small syntactic sugar brought by Swift, the change made in
the function body will not propagate outside the function body.</p>

<h2 id="toc_5">In-Out parameters</h2>

<p>Prefix parameters names with keyword <code>inout</code> (which implies <code>var</code>) to make the
change to the parameter inside function body propagate outside.</p>

<p>When specifying argument for <code>inout</code> parameters, prepend <code>&amp;</code> to the argument
name to indicate that it could be modified during the function call.</p>

<p>In-out parameters cannot have default values, and variadic parameters cannot be
marked as <code>inout</code>. If you mark a parameter as <code>inout</code>, it cannot also be marked
as var or let.</p>

<pre><code class="language-swift">func swapTwoInts(inout a: Int, inout b: Int) {
    let temporaryA = a
    a = b
    b = temporaryA
}

var a = 2
var b = 10
swapTwoInts(&amp;a, &amp;b)
println(&quot;after swapping, a = \(a), b = \(b)&quot;)
</code></pre>

<h1 id="toc_6">Function Return Values</h1>

<p>Functions without a defined return type return a special value of type
<strong>Void</strong>.  This is simply an empty tuple, in effect a tuple with zero elements,
which can be written as <code>()</code>.</p>

<p>You can use a tuple type (or a optional tuple) as the return type for a
function to return multiple values as part of one compound return value.</p>

<pre><code class="language-swift">// wrap multiple return values in an optional tuple.
func minMax(array: [Int]) -&gt; (min: Int, max: Int)? { ... }

if let minMax = minMax([1,2,3]) {
  // use name to fetch tuple element.
  println(&quot;min: \(minMax.min)\tmax: \(minMax.max)&quot;)

  // use index to fetch tuple elements.
  println(&quot;min: \(minMax.0)\tmax: \(minMax.1)&quot;)
}
</code></pre>

<h1 id="toc_7">Function Types</h1>

<p>In Swift, function is first class object, so feel free to use them as other
normal objects:</p>

<ul>
<li><p>passing them as argument into functions.</p></li>

<li><p>return them from functions.</p></li>

<li><p>declare theme as type alias for convenience.</p></li>

<li><p>even nest their in another function.</p></li>

<li><p>&hellip;</p></li>
</ul>

<pre><code class="language-swift">typealias cmp = (Int, Int) -&gt; Bool

func whichCmp(functionPassedIn: ()-&gt; Bool) -&gt; cmp {
  func Foo(lhs: Int, rhs: Int) -&gt; Bool {
    return false
  }

  func Hoo(lhs: Int, rhs: Int) -&gt; Bool {
    return true
  }

  return functionPassedIn() ? Foo : Hoo
}

func aFunc() -&gt; Bool {
  return false
}

whichCmp(aFunc)(1334, 234)
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/ios_notes_casting/">
            iOS NOTES - CASTING
          </a>
        </h1>

        <span class="post-date">Sun, Apr 12, 2015</span>

        

<p>Collect all my gain from study &amp; using Swift&rsquo;s casting mechanism here.</p>

<p>First defining a sample class hierarchy:</p>

<pre><code class="language-swift">class SuperClass {
  func say() {
    println(&quot;super class&quot;)
  }
}

class Subclass: SuperClass {
  override func say() {
    println(&quot;subclass&quot;)
  }
}
</code></pre>

<h1 id="toc_0">3 Kinds of Castings</h1>

<ol>
<li><p>Natural Casting</p>

<p>Used in <strong>up-casting</strong> (i.e. casting from a sub-class instance to a super
class instance)</p>

<pre><code class="language-swift">var a = SubClass()
var b = a as SuperClass
</code></pre></li>

<li><p>Unconditional Casting (or forced casting)</p>

<p>Used in <strong>down-casting</strong> (i.e. the contrary of the above).</p>

<p>When the casting failed, it would incur a panic.</p>

<p>Use it when you are confident about the down-casting.</p></li>

<li><p>Conditional Casting</p>

<p>Used in <strong>down-casting</strong>, but it always returns optionals whether succeed
or fail, that means when not
applicalbe, instead of emitting a panic, it returns nil.</p></li>
</ol>

<p>Conclusion:</p>

<ul>
<li><p>Natural casting is used in <em>always-succeed</em> castings.</p></li>

<li><p>Conditional &amp; Unconditional castings are used in <em>might-fail</em> castings.</p></li>
</ul>

<h1 id="toc_1">2 Operator for Casting</h1>

<ol>
<li><p>The <code>is</code> operator</p></li>

<li><p>The <code>as</code> operators - <code>as</code>, <code>as?</code>, <code>as!</code></p></li>
</ol>

<h1 id="toc_2">Special casting scenarios in practice</h1>

<h2 id="toc_3">Protocol Casting</h2>

<p>In Swift the relationship between a protocol and the classes adopting that
protocol is like the relationship between a super class and its&rsquo; sub-classes.
Hence casting a protocol object, such as the <code>AnyObject</code> to its&rsquo; underlying
class is regarded as a down-casting.</p>

<pre><code class="language-swift">import UIKit // import AppKit

let a: AnyObject = &quot;String&quot;
let b: a as! String
</code></pre>

<p>There are 3 special types: <code>Any</code>, <code>AnyObject</code>, <code>AnyClass</code>.</p>

<p>By tracing the source code, you would find the following:</p>

<pre><code class="language-swift">/// The protocol to which all classes implicitly conform.
///
/// When used as a concrete type, all known `@objc` methods and
/// properties are available, as implicitly-unwrapped-optional methods
/// and properties respectively, on each instance of `AnyObject`.
@objc procotol AnyObject {}

/// The protocol to which all class types implicitly conform.
///
/// When used as a concrete type, all known `@objc` `class` methods and
/// properties are available, as implicitly-unwrapped-optional methods
/// and properties respectively, on each instance of `AnyClass`.
typealias AnyClass = AnyObject.Type

/// The protocol to which all types implicitly conform
typealias Any = protocol&lt;&gt;
</code></pre>

<p>There exists a prerequisite for the rules all above: the <code>Foundation</code> framework
must be imported. (Usually, you import <code>UIKit</code> or <code>AppKit</code>, which implicitly
import <code>Foundation</code> framework). Only then can swift compiler be able to
recognize the <code>@objc</code> keyword, and have Objective-C type bridging ability.</p>

<h2 id="toc_4">Optional AnyObject Collection Casting</h2>

<p>For a optional of Collection of AnyObject that reference objects of the same
class (or super class) T, can be [un]conditionally casted to [T] (without
being wrapped in optional anymore)</p>

<pre><code class="language-swift">import UIKit // import Appkit

// optional array of String.
let a: [AnyObject]? = [&quot;Newyork&quot;, &quot;London&quot;, &quot;Peking&quot;]
let b = a as! [String] // succeed.

// optional array of mixed object that have no common super class.
let a: [AnyObject]? = [&quot;Newyork&quot;, 1983, 3.14, false]
let b = a as! [String] // fail: not all element are of String.

// optinal array of mixed objects that derived from the same super class.
let a: [AnyObject]? = [Subclass(), SuperClass(), SuperClass(), Subclass()]
let b = a as! [Subclass] // succeed: not all element are of String.

// implicitly unwrapped optional dictionary with String typped keys and Int typed values.
let a: [NSObject: AnyObject]! = [&quot;id1&quot;: 32, &quot;id2&quot;: 66]
if let b = a as? [String: Int] {
  println(b)
}
</code></pre>

<p>In the code list above, the String is a structure type in Swift (no a class
type), but it can also be referenced by a <code>AnyObject</code> instance. The rules come
from the following excerpt from &ldquo;Using Swift with Cocoa and Objective-C&rdquo;
official document:</p>

<blockquote>
<p>An object is AnyObject compatible if it is an instance of an Objective-C or
Swift class, or if the object can be bridged to one.</p>
</blockquote>

<p>There exist several swift - Objective-C type bridging depicted as follows:</p>

<p><img src="../../../note/swift_objc_bridging.svg" alt="Siwft - Objective-C Bridging" />
</p>

<p>Hence, back to the code listing above, the Swift type <code>String</code> can be bridged
to NSString <code>Foundation</code> class, then it is <code>AnyObject</code> compatible.</p>

<p>In practice, there exists quit a few occasions that you need to cast optional
collections to type specific Swift collections to utilize their underlying
methods or properties.</p>

<p>For example, when you invoke the Objective-C APIs that return <code>NSArray</code>,
<code>NSDictionary</code>, <code>NSSet</code>, you would get <code>[AnyOject]!</code> <code>[NSObject: AnyOject]!</code>,
<code>[NSObject]!</code> respectively, you could cast [un]conditionally to a more concrete
Swift collection type before you access the individual elements within they.</p>

<p>When you use <code>as!</code> (the unconditional casting), you got an unwrapped collection
in one line of code.</p>

<pre><code class="language-swift">let asset: AVURLAsset = ...
for meta in asset.commonMetadata as! [AVMetadataItem] {
  switch meta.commonKey {
  case AVMetadataCommonKeyTitle:
    item.title = meta.stringValue
  case AVMetadataCommonKeyArtist:
    item.artist = meta.stringValue
  case AVMetadataCommonKeyAlbumName:
    item.albumName = meta.stringValue
  case AVMetadataCommonKeyArtwork:
    switch meta.value {
    case let data as NSData:
      item.artwork = UIImage(data: data)
    case let dict as [NSObject: AnyObject]:
      item.artwork = UIImage(data: dict[&quot;data&quot;] as! NSData)
    default:
      assert(false, &quot;Invalid metadata value type&quot;)
    }
  default:
    break
  }
}
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/ios_notes_keyboard/">
            iOS NOTES - KEYBOARD
          </a>
        </h1>

        <span class="post-date">Wed, Apr 8, 2015</span>

        

<p>Handle iOS keyboard poppu &amp; resignment gracefully.</p>

<h1 id="toc_0">UIWindow provide 6 keyboard related notifications</h1>

<ul>
<li><code>UIKeyboard[Will/Did]ShowNotification</code></li>
<li><code>UIKeyboard[Will/Did]HideNotification</code></li>
<li><code>UIKeyboard[Will/Did]ChangeFrameNotification</code></li>
</ul>

<p>After playing with these notifications above, I found:</p>

<ol>
<li><p>When you want to move obscured contents or views to above the keyboard, put
the frame adjustment code in *<strong>Will</strong>* notifications, because the handler
methods seems to be invoked within the same animation block that provides
the keyboard revealing animation.</p></li>

<li><p>If you are only interested in tracing keyboard&rsquo;s frame (more specifically the
height) during keyboard&rsquo;s presence, monitoring
<code>UIKeyboardWillShowNotification</code> seems enough, no need to monitoring
<code>UIKboardWillChangeFrameNotification</code> additionally.</p></li>

<li><p>The frame size stored in <code>UIKeyboardFrameBeginUserInfoKey</code> and
<code>UIKeyboardFrameEndUserInfoKey</code> keys will only differ after keyboard is
first shown and before it is hidden. When the keyboard is first shown or is
resigned, the <code>Begin</code> or <code>End</code> frame is equal.</p></li>
</ol>

<h1 id="toc_1">Strategies for move contents above the keyboard:</h1>

<h2 id="toc_2">For contents embedded in <code>UISCrollView</code>s</h2>

<p>Way #1 &ndash; Adjust the bottom edge inset value of the containing scroll view&rsquo;s
contentsInset property and scroll active view into visible area using
<code>scrollRectToVisible: animated:</code> method.</p>

<p>Way #2 &ndash; Adjust containing scroll view&rsquo;s contentSize &amp; contentOffset
properties.</p>

<p>No matter which way above you choose, remember to adjust
<code>scrollIndicatorInsets</code>&rsquo;s bottom edge inset value to make the indicator fully
un-obscured from the keyboard.</p>

<h2 id="toc_3">For contents outside any <code>UIScrollView</code></h2>

<p>Recalculate and set its&rsquo; frame.origin.y value in
<code>UIKeyboardWillShowNotification</code> handler method, and the movement will be
animated along with the revealing of keyboard perfectly.</p>

<pre><code class="language-swift">func handleKeyboardNotification(notify: NSNotification) {
  let value = notify.userInfo?[UIKeyboardFrameEndUserInfoKey] as NSValue
  let keyboardHeight = value.CGRectValue().height

  switch notify.name {

  case UIKeyboardWillShowNotification:
    theViewToMove.frame.origin.y = self.view.bounds.height - keyboardHeight - theViewToMoveMargin - theViewToMove.bounds.height
    theScrollViewToAdjust.contentInset.bottom = keyboardHeight
    itemsTable.scrollIndicatorInsets.bottom = keyboardHeight

  case UIKeyboardWillHideNotification:
    theViewToMove.frame.origin.y = self.view.bounds.height - theViewToMoveMargin - theViewToMove.bounds.height
    theScrollViewToAdjust.contentInset.bottom = 0.0
    itemsTable.scrollIndicatorInsets.bottom = 0.0 // the default value

  default:
    assert(false)
  }
}
</code></pre>

<h1 id="toc_4">References:</h1>

<ul>
<li><p><a href="https://developer.apple.com/library/ios/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html#//apple_ref/doc/uid/TP40009542-CH5-SW7">Moving Contents That is Located Under the Keyboard in Text Programming Guide for iOS</a></p></li>

<li><p><a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIWindow_Class/">UIWindow Class Reference</a></p></li>
</ul>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/engligh_vocabulary_confusion/">
            ENGLISH VOCABULARY - CONFUSION GROUPS
          </a>
        </h1>

        <span class="post-date">Sun, Mar 29, 2015</span>

        <p>Words groups I collected when expand my vocabulary.</p>

<p>Will expand it day by day!</p>

<blockquote>
<p>Hew out of the mountain of despair a stone of hope and you can make you life
a splendid one!</p>
</blockquote>

<hr />

<p>amnesia<br />
anemia (anaemia), anaemic<br />
anorexia</p>

<hr />

<p>similar, similarity<br />
simulate, dissimulate ( = dissemble ), imitate, emulate<br />
assimilation &lt;-&gt; dissimilation != dissemination<br />
stipulate<br />
stimulate, stimulus, stimulant<br />
imitate<br />
intimate<br />
intimidate == browbeat, bluster, cow, intimidating == intimidatory, intimidator, intimidation</p>

<hr />

<p>analgesic, analgesia<br />
anesthetic, anesthesia<br />
anaesthetic, anaesthesia<br />
antibiotic<br />
antibody<br />
antidote<br />
antiseptic, aseptic</p>

<hr />

<p>absurd<br />
abuse, disabuse<br />
amuse, amusing, amusement<br />
accuse, accusation<br />
accuser &lt;&ndash;&gt; defendant, accused</p>

<hr />

<p>agile, agility<br />
fragile, fragility, crisp, brittle, delicate</p>

<hr />

<p>anaerobe, anaerobic<br />
anhydrous, dehydrate<br />
anorexia</p>

<hr />

<p>affable<br />
amiable, amity<br />
amicable</p>

<hr />

<p>acuity<br />
acumen</p>

<hr />

<p>accumulate, accumulation<br />
cumulate, cumulus<br />
curdle, coagulate, congeal, clot, gel<br />
commutative</p>

<hr />

<p>antipathy<br />
animus, animosity<br />
abominate, abomination<br />
averse, aversion</p>

<hr />

<p>abrogate<br />
abnegate<br />
abstain<br />
abolish<br />
annul<br />
renounce</p>

<hr />

<p>absolve, absolution<br />
amnesty<br />
acquittal</p>

<hr />

<p>allege, allegory, allegation<br />
arrogate<br />
aphorism</p>

<hr />

<p>annex, annexation<br />
adjunct<br />
addendum<br />
accessory (or, accessary)</p>

<hr />

<p>necessary, necessitous<br />
accessory<br />
accessibility</p>

<hr />

<p>apex<br />
acme != acne<br />
crest<br />
cusp<br />
climax, anticlimax<br />
peak</p>

<hr />

<p>alloy<br />
alley<br />
allay<br />
ally, alliance</p>

<hr />

<p>vow<br />
avow<br />
vowel<br />
bowel</p>

<hr />

<p>aver<br />
averse, aversion<br />
avert<br />
adverse, adversity<br />
advertise, advertisement</p>

<hr />

<p>averse<br />
animus, animosity<br />
hostility, hostile &lt;&ndash;&gt; hospitality, hospitable<br />
antagonism, antagonise, antagonist</p>

<hr />

<p>artery, aorta<br />
vein<br />
vessel<br />
vascular<br />
corpuscle<br />
anemia</p>

<hr />

<p>throat<br />
lung<br />
liver<br />
gallbladder &ndash;&gt; bile (or, choler, gall)<br />
stomach<br />
bowel, intestine, small, intestine, large, intestine<br />
bladder<br />
anus</p>

<hr />

<p>appear, appearance<br />
appeal, appealing<br />
apparent, apparel<br />
appease, appeasing, appeasement</p>

<hr />

<p>consider, considerable, considerate<br />
appreciate, appreciable<br />
appropriate, appropriateness, appropriation</p>

<hr />

<p>condiment<br />
salt, pepper, vinegar, sugar</p>

<hr />

<p>bounteous, courteous<br />
courtesy, courteous</p>

<hr />

<p>demo<br />
democrat, democracy, demotic != demonic<br />
demagogue<br />
demolish, demolishment</p>

<hr />

<p>coral<br />
corral<br />
carol<br />
cameo</p>

<hr />

<p>asthma<br />
anthem, carol<br />
chrysanthemum<br />
chrysalis<br />
talisman</p>

<hr />

<p>chasm<br />
canyon<br />
canny</p>

<hr />

<p>precious<br />
appreciate<br />
appreciable, inappreciable<br />
depreciate</p>

<hr />

<p>contrite, contrition<br />
chondrite</p>

<hr />

<p>canoe<br />
clue<br />
cliff</p>

<hr />

<p>boisterous<br />
cloister</p>

<hr />

<p>comely<br />
comet<br />
comedy<br />
comity<br />
comic</p>

<hr />

<p>atherosclerosis<br />
arteriosclerosis</p>

<hr />

<p>contentious<br />
argumentative</p>

<hr />

<p>deforestation<br />
conflagration</p>

<hr />

<p>covenant<br />
conversant<br />
countenance</p>

<hr />

<p>allege, allegation<br />
arrogate, arrogation<br />
arrogant, arrogance<br />
abrogate<br />
derogate, derogatory, derogative<br />
surrogate</p>

<hr />

<p>axle<br />
axis<br />
axe<br />
axiom, axiomatic<br />
aphorism, aphorize<br />
pith, pithy</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/error_collection_ios/">
            ERROR COLLECTION - IOS
          </a>
        </h1>

        <span class="post-date">Sat, Feb 7, 2015</span>

        <p>Errors that I collected day by day, when developing iOS apps.</p>

<ul>
<li><p>Specifying an invalid frame size (i.e. 0 width or 0 height), can make
UIView&rsquo;s such as UISlider unresponsive to user interaction.</p></li>

<li><p>Always wrap multiple statements following a <code>switch case:</code> in a curly brace,
where we can even put a variable declaration in it.</p></li>

<li><p>Should <strong>NOT</strong> assgin one instance of <code>UIImage</code> to multiple
<code>UITextField.leftView</code> or <code>UITextField.rightView</code> properties.</p></li>

<li><p>UIImageView, by defaults, is <strong>NOT</strong> userInteractionEnabled, hence sub views
under them may not receive touch events.</p></li>

<li><p>When creating outlets for UILabel views, <strong>DO NOT</strong> name the property
&ldquo;title&rdquo;, cause the super class of your view controller <code>UIViewController</code>
itself has a property &lsquo;title&rsquo;, it will incur exception at runtime time.</p></li>

<li><p>Remember to clean dead connnection recorded by storyboards for controls &amp;
views in interface builder window.</p></li>

<li><p>Dragging an element with <Atl> key pressed, will copy it&rsquo;s attributes as well as
it&rsquo;s connections and other info set in the interface builder and uitility
panes.</p></li>

<li><p>When presenting a view controller from a content view controller embeded in a
<strong>navigation view controller</strong>, it is the navigation view controller, rather
than the embeded content view controller, which is <strong>presenting</strong> the view
controller.</p></li>

<li><p>When customizing table view cells, <strong>DOT NOT</strong> use <code>UIButton</code> to cover the cell for
triggering the segue, which would bring a function redundant and thus
complicates things.</p></li>

<li><p><strong>DO NOT</strong> auto-layout a subview within a auto-layout&rsquo;ed <code>UIScrollView</code> when
you plan to perform zooming operation in it.</p></li>

<li><p>After getting a reused cell, make sure all its&rsquo; states get reset to the current
value or the default value, otherwise the remained states set by last usage
would mess your up.</p></li>

<li><p>setting <code>clipsToBounds</code> to true will clips layer shadow off.</p></li>
</ul>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/setup_my_archlinux_environment/">
            SETUP MY ARCH LINUX ENVIRONMENT
          </a>
        </h1>

        <span class="post-date">Sat, Nov 8, 2014</span>

        

<p>The marathon of installing &amp; tunning the Arch Linux to my flavor.</p>

<h1 id="toc_0">SUMMARY</h1>

<p><a href="https://wiki.archlinux.org">Arch Linux</a> + <a href="http://awesome.naquadah.org">Awesome WM</a> + <a href="http://invisible-island.net/xterm/">xterm</a>, that is the
main skeleton of my system.</p>

<p>I settled on this combination under the rule:</p>

<ul>
<li><p>minimalistic environment, no huge DEs like GNOME, KDE or the likes.</p></li>

<li><p>fast revolution, always surfing in the front, since it is for personal use,
why not &hellip;</p></li>
</ul>

<p>I choose <a href="http://www.freedesktop.org/wiki/Software/LightDM/">LightDM</a>, because it</p>

<ol>
<li><p>is developed <strong>independent</strong> of other DEs, hence I don&rsquo;t have to be forced to
install a bunch of GNOME or KDE dependency packages to only for making it
run.</p></li>

<li><p>is <strong>lightweight</strong>. Very small package size, therefore starts up pretty fast, as
I can see.</p></li>

<li><p>has many front ends (a.k.a. <em>greeters</em>) due to it cross-desktop feature.</p></li>
</ol>

<p>Among various <a href="https://wiki.archlinux.org/index.php/lightdm#Greeter">greeters</a>, I currently use <code>lightdm-gtk3-greeter</code>. It
has a simplistic and neat login screen, just the necessary elements I need.</p>

<h1 id="toc_1">THE WINDOW MANAGER &ndash; AWESOME WM</h1>

<p>I have tried two ways of starting Awesome WM during system boot.</p>

<p>The first way, is using a <em>display manager</em>, which will presents you a login
screen, where you enter your user ID &amp; password. After authentication, it
will start the Awesome WM for you.</p>

<p>The second way is to use <code>xinit</code> (and it&rsquo;s front-end script <code>startx</code>). When
display manager is absent in the startup process, system will bring you to one
of the tty consoles, which is just a simplistic command line interface, then
you type <code>startx</code> manually, which then, according the configuration in
<code>~/.xinitrc</code>, do some initial setting work and finally start the Awesome WM and
transfer control to it.</p>

<p>Of the 2 ways I&rsquo;ve tried, I prefer the first one &ndash; using a display
manager. Because the display manager:</p>

<ul>
<li><p>the installation &amp; configuration process is relatively simpler than the
<em>xinit</em> way.</p></li>

<li><p>startup dependent services (e.g. audio, network etc.) in correct order
thanks to <code>systemd</code>&rsquo;s dependency management.</p></li>

<li><p>fully utilize the <code>systemd</code>&rsquo;s concurrency startup feature, making the whole
startup process pretty faster than the <em>xinit</em> way.</p></li>

<li><p>run fast, there is no need to login to tty console, and type &hellip;, which as
I&rsquo;ve seen, took more time to initiates.</p></li>
</ul>

<h2 id="toc_2">With display manager</h2>

<h3 id="toc_3">Installing LightDM</h3>

<p>First, install <code>LightDM</code> &amp; <code>lightdm-gtk3-greeter</code> from official repository. An
extra advantage of choosing <code>lightdm-gtk3-greeter</code> is that you do not need to
modify the <code>/etc/lightdm/lightdm.conf</code> to let the <code>LightDM</code> back-end use it. It
is the reference (default) greeter.</p>

<p>Then register <code>LightDM</code> to <code>systemd</code>, making it get started on boot
automatically.</p>

<pre><code class="language-bash">sudo pacman -S lightdm, lightdm-gtk3-greeter

sudo systemctl enable lightdm.service
</code></pre>

<h3 id="toc_4">Configuring LightDM</h3>

<h2 id="toc_5">Without display manager</h2>

<p>Without display manager, you should first login into the <code>tty1</code>, then type
<code>startx</code> to start the <em>Awesome WM</em>.</p>

<p>Through some configuration, the 2 steps mentioned above can be automated:</p>

<h3 id="toc_6">Step 1 &ndash; automatic login to virtual console</h3>

<p>create the following file and its&rsquo; parent directory if not exists.</p>

<pre><code class="language-conf"># /etc/systemd/system/getty@tty1.service.d/autologin
------------------------------------------------------------------------------
[Service]
ExecStart=
ExecStart=-/usr/bin/agetty --autologin mudox --noclear %I 38400 linux
Type=idle
</code></pre>

<h3 id="toc_7">Step 2 &ndash; start X at login</h3>

<p>First install the <code>xorg-xinit</code> package from the Arch Linux official
repository, which provides the <code>xinit</code> command &amp; its&rsquo; front end &ndash; the <code>startx</code>
script, besides, it also put a template <em>xinitrc</em> file under <code>/etc/skel/</code>
directory.</p>

<p>Then, base on <code>/etc/skel/.xinitrc</code>, create <code>~/.xinitrc</code> as follows:</p>

<pre><code class="language-bash">#!/bin/sh
#
# ~/.xinitrc
#
# Executed by startx (run your window manager from here)

if [ -d /etc/X11/xinit/xinitrc.d ]; then
  for f in /etc/X11/xinit/xinitrc.d/*; do
    [ -x &quot;$f&quot; ] &amp;&amp; . &quot;$f&quot;
  done
  unset f
fi

xrdb -merge ~/.Xresources # if you have ever created it.

# exec gnome-session
# exec startkde
# exec startxfce4

exec awesome # make sure it's on the last line
</code></pre>

<p>Finally, add the following code into you shell login script, such as <em>.profile</em>
for bash and <em>.zlogin</em> for zsh.</p>

<pre><code class="language-bash"># ~/.zlogin
------------------------------------------------------------------------------
[[ -z $DISPLAY &amp;&amp; $XDG_VTNR -eq 1 ]] &amp;&amp; exec startx
</code></pre>

<p>references:</p>

<ul>
<li><p><a href="https://wiki.archlinux.org/index.php/Automatic_login_to_virtual_console">Automatic login to virtual console from
ArchWiki</a></p></li>

<li><p><a href="https://wiki.archlinux.org/index.php/Start_X_at_login">Start X at login from ArchWiki</a></p></li>

<li><p><a href="https://wiki.archlinux.org/index.php/Xinitrc">xinitrc form ArchWiki</a></p></li>
</ul>

<h1 id="toc_8">MOUSE ACCELERATION</h1>

<p>Type <code>xset q | grep Pointer</code> to see current mouse acceleration setting.</p>

<p>Try <code>xset m &lt;acceleration&gt; &lt;threshold&gt;</code> with different values to find the best
combination for your feeling.</p>

<blockquote>
<p>where acceleration defines how many times faster the cursor will move than
the default speed. threshold is the velocity required for acceleration to
become effective, usually measured in device units per 10ms. acceleration can
be a fraction, so if you want to slow down the mouse you can use <sup>1</sup>&frasl;<sub>2</sub>, <sup>1</sup>&frasl;<sub>3</sub>,
<sup>1</sup>&frasl;<sub>4</sub>, &hellip; if you want to make it faster you can use <sup>2</sup>&frasl;<sub>1</sub>, <sup>3</sup>&frasl;<sub>1</sub>, <sup>4</sup>&frasl;<sub>1</sub>, &hellip;</p>

<p>Threshold defines the point at which acceleration should occur in pixels per
10 ms.</p>
</blockquote>

<p>I found my lucky combiantion is <code>1/4 8</code> and I add the setting command into
<em>rc.lua</em> of <a href="http://awesome.naquadah.org">Awesome WM</a> to apply the setting on each startup.</p>

<p>references:</p>

<ul>
<li><a href="https://wiki.archlinux.org/index.php/Mouse_acceleration">Mouse acceleration from ArchWiki</a></li>
</ul>

<h1 id="toc_9">INPUT METHOD</h1>

<p>The <strong>ibus + isbus-rime</strong> combinations works nicely on my Arch Linux.</p>

<p>After ibus gets installed, run <code>ibus-setup</code>, it will show a setting guide
window where you can adjust ibus settings to adapt to <a href="awesome">Awesome WM</a>
environment.</p>

<ul>
<li><p>I prefer to change the keyboard shortcut of switching to next input method to
<code>&lt;Atl&gt;&lt;Shift&gt;space</code></p></li>

<li><p>Check off the <em>Embed preedit text in application window</em> option, because I
found it does not run properly in some applications (e.g. Vim).</p></li>
</ul>

<p>On  environments, ibus-daemon can not be loaded automatically on
startup, so we need to manually run it. There are many ways to auto-start
applications on linux platform, I choose to let <a href="awesome">Awesome WM</a> to start it by adding
auto-start code in <em>rc.lua</em>.</p>

<p>For ibus-rime, it is in tranditional chinese mode by default. To switch to
simplified chinese mode, press <code>Ctrl-~</code> when ibus-rime is active to open setup
candiate menu and choose <em>朙月拼音-简化字</em></p>

<pre><code class="language-bash">sudo pacman -S ibus ibus-qt ibus-rime

ibus-setup

# manually start ibus daemon for this session.
# this command has been added in my Awesome config file 'rc.lua' to auto-start
# it in the beginning of each Awesome session.
ibus-daemon -drx
</code></pre>

<p>references:</p>

<ul>
<li><a href="https://wiki.archlinux.org/index.php/Ibus">IBus from ArchWiki</a></li>
</ul>

<h1 id="toc_10">WINDOW MANAGER</h1>

<p>On Linux platforms, I prefer WMs to DEs.</p>

<p>The <a href="http://awesome.naquadah.org">Awesome WM</a> is my favorite window manager.</p>

<p>see <a href="/memo/setup_my_aweseome_wm_environment/">SETUP MY AWESOME WM ENVIRONMENT</a>
for details.</p>

<h1 id="toc_11">SHELL ENVIRONMENT</h1>

<p>I have used several terminal emulators (gnome-terminal, xvrt &hellip;), and finally
I settled myself on <strong>xterm</strong>, which I feel it:</p>

<ul>
<li><p>consume the smallest resource among other terminal emulators.</p></li>

<li><p>starts up very fast.</p></li>

<li><p>is much more robust.</p></li>

<li><p>is the standard shell for the X Window System, which bring a great
compatiblity.</p></li>
</ul>

<p>As to shells, I become a <strong>zsh</strong> fan soon after played with it as well as
bash &amp; fish shells. the reason is obvious:</p>

<ul>
<li><p>it is powerfull than bash, whose syntax is completely covered by zsh.</p></li>

<li><p>it provides more flexibility in configuration than fish shell.</p></li>

<li><p>there already exist quite a many user contributed resources on the net, e.g:</p>

<ul>
<li><p><a href="https://github.com/robbyrussell/oh-my-zsh">on-my-zsh</a>.</p></li>

<li><p><a href="https://github.com/zsh-users/antigen">antigen</a> plugin manager.</p></li>
</ul></li>
</ul>

<h2 id="toc_12">Pull down dot-files repo</h2>

<p>My configuration resource related to termianl emulator &amp; shells are managed in
a github repo &ndash; <a href="https://github.com/Mudox/dot-files.git">dot-files</a>.</p>

<pre><code class="language-bash">cd ~/Git # ~/Git is the place I assemble most of my github repos.
git clone https://github.com/Mudox/dot-files.git
</code></pre>

<h2 id="toc_13">Setup xterm</h2>

<p>First, install xterm from Arch Linux&rsquo;s official repository.</p>

<p>Then, link out the .Xresources file from my <a href="https://github.com/Mudox/dot-files.git">dot-files</a> repo. It is
the configuration file that hold my xterm settings (colors, cursors, fonts
etc.) among other x utility setttings.</p>

<pre><code class="language-bash">sudo pacman -S xterm
cd ~
ln -sf Git/dot-files/Xresources .Xresources
</code></pre>

<h2 id="toc_14">Setup zsh</h2>

<p>see <a href="/memo/setup_my_zsh_environment/">SETUP MY ZSH ENVIRONMENTS</a> for details.</p>

<h1 id="toc_15">SETUP VIRTUALBOX</h1>

<h2 id="toc_16">Installing Virtualbox</h2>

<p>First, from the official repository, install <code>virtualbox</code> package, which comes
with <code>virtualbox-host-modules</code>.</p>

<p>Then we need to add the basic <strong>vboxdrv</strong> kernel module to host kernel.</p>

<p>Finally, add my user name to the <strong>vboxusers</strong> group in order to use USB port in
virtual machines.</p>

<pre><code class="language-bash">sudo pacman -S virtualbox

# manually add vboxdrv to host kernel for one time.
sudo modeprobe vboxdrv

# auto-load vboxdrv on every system startup.
sudo echo 'vboxdrv' &gt; /etc/modules-load.d/virtualbox.conf

# add user name in vboxusers group to use USB ports in vitual machines.
sudo gpasswd -a &quot;${USER}&quot; vboxusers
</code></pre>

<h2 id="toc_17">Configuring Virtualbox</h2>

<ol>
<li><p>Set <em>Host Key Combination</em> to <code>right &lt;winkey&gt;</code> which is consistent with
<a href="awesome">Awesome WM</a>&rsquo;s keyboads shortcuts, it&rsquo;s in
<em>File-&gt;Preference-&gt;Input-&gt;Virtual Machine</em> of <em>Oracle VM VitualBox Manager</em>
window.</p></li>

<li><p>Enalbe <em>Bidiretional clipboard</em>, it&rsquo;s in <em>Devices-&gt;Shared
Clipboard-&gt;Bidirectional</em> of virtual machine window.</p></li>
</ol>

<p>references:</p>

<ul>
<li><p><a href="https://wiki.archlinux.org/index.php/Virtualbox">Virtualbox from ArchWiki</a></p></li>

<li><p><a href="https://wiki.archlinux.org/index.php/Kernel_modules">kernel_modules from ArchWiki</a></p></li>
</ul>

<h1 id="toc_18">VPN</h1>

<h2 id="toc_19">Setup pptpclient</h2>

<ol>
<li><p>install pptpclient from the official repository of Arch Linux.</p></li>

<li><p>use <code>pptpsetup</code> command to register my VPN account, which is just a helper
script that will create a readable text file <code>/etc/ppp/peers/&lt;tunnel_name&gt;</code>
where you can change the server address manaually using whatever text editor
you like. collect the following information in advance:</p>

<ul>
<li><p>VPN server&rsquo;s <strong>ip address</strong> from your VPN provider.</p></li>

<li><p><strong>user name</strong> of your VPN account.</p></li>

<li><p><strong>user password</strong> of your VPN account.</p></li>
</ul></li>

<li><p>install <code>ppp-mppe</code> (i.e. Microsoft Pointer-to-Pointer Encryption), if the
<code>pptpsetup</code> command complains about <em>MPPE</em> module things.</p></li>

<li><p>test configuration</p>

<ul>
<li><p>use <code>pon &lt;tunnel_name&gt; debug dump logfd 2 nodetach</code> to test the
configuration. If everything has been configured correctly, the command
should not terminate. <code>Ctrl-C</code> to quit it.</p></li>

<li><p>type <code>ip addr show</code>, and you will see a new device <strong>ppp0</strong> is listed in.</p></li>
</ul></li>

<li><p>connect VPN using <code>sudo pon &lt;tunnel_name&gt;</code>, <code>sudo poff &lt;tunnel_name&gt;</code> to
tear down.</p></li>
</ol>

<pre><code class="language-bash"># install pptpclient
sudo pacman -S pptpclient

# add you VPN account (i.e. create a new tunnel)
sudo pptpsetup \
  --create &lt;tunnel_name_whatever_you_like&gt; \
  --server &lt;your_VPN_server_ip_address&gt; \
  --username &lt;username_of_you_VPN_account&gt; \
  --password &lt;password_of_you_VPN_account&gt; \
  --encrypt

# install ppp-mppe, if the command above complains about lacking of `MPPE`
# module things. rerun `pptpsetup` command above after installing it.
sudo pacman -S ppp-mppe

# test 1, the command should not terminate if everything is okay.
sudo pon &lt;tunnel_name_above&gt; debug dump logfd 2 nodetach

# test 2, you would see `ppp0` listed in the output.
ip addr show

# finally, connect!
sudo pon &lt;tunnel_name&gt;
</code></pre>

<h2 id="toc_20">Route all traffic through VPN connection</h2>

<h3 id="toc_21">Manually</h3>

<p>Use the powerfull <code>ip</code> command to add a route rule into route table.</p>

<pre><code class="language-bash"># make all packages go through interface ppp0
ip route add default dev ppp0
</code></pre>

<p>This route rule is only effective during this ppp session. after your tear down
the VPN connection by <code>sudo pon &lt;tunnel_name&gt;</code>, it will vanish.</p>

<h3 id="toc_22">Automatically</h3>

<p>Every executable scripts under /etc/ppp/ip-up.d/ will be called when a VPN
connection startup. Hence, we can use it to automatically set route rules.</p>

<pre><code class="language-bash"># /etc/ppp/ip-up.d/01-routes.sh
# ----------------------------------------
#!/bin/bash

# This script is called with the following arguments:
# Arg Name
# $1 Interface name
# $2 The tty
# $3 The link speed
# $4 Local IP number
# $5 Peer IP number
# $6 Optional ``ipparam'' value foo

ip route add default via $4
</code></pre>

<pre><code class="language-bash">cd /etc/ppp/ip-up.d
echo 'ip route add default via $4' &gt; 01-routes.sh

# the script file need to have `x` permission to be run.
# it's stdin &amp; stderr will be redirected off terminal, so not output will
# be shown when run.
co
sudo chmod +x /etc/ppp/ip-up.d/01-routes.sh
</code></pre>

<h2 id="toc_23">Modify DNS server list</h2>

<p>If you found you still can not access some site (e.g. youtube, twitter, etc.)
after establishing the VPN connection, then you should insert <code>servername
8.8.8.8</code> ahead of existing lines in <em>/etc/resolve.conf</em>.</p>

<pre><code class="language-bash"># /etc/resolve.conf
# ----------------------------------------
nameserver 8.8.8.8
nameserver 192.168.0.1
</code></pre>

<h3 id="toc_24">My hacky way</h3>

<p>I wrote a script to get around of this:</p>

<pre><code class="language-bash"># ~/.bin/vpn.sh
# ----------------------------------------
#!/bin/sh

tunnel=&quot;your configured tunnel name&quot;

if [ &quot;$#&quot; -ne 1 ]; then
  echo &quot;usage: $0 [on|off]&quot;
  exit 1
fi

case &quot;$1&quot; in
  on )
    # connect
    pon ${tunnel} || exit 1

    # here we just overwrite the /etc/resolv.conf by `echo`ing the hard
    # written DNS list to it.
    printf &quot;nameserver 8.8.8.8\nnameserver 192.168.0.1&quot; &gt; /etc/resolv.conf || exit 1
    ;;
  off )
    # disconnect
    poff ${tunnel}

    # some as above, we just `echo` back.
    echo 'nameserver 192.168.0.1' &gt; /etc/resolv.conf || exit 1
    ;;
  * )
    echo &quot;usage: $0 [on|off]&quot;
    ;;
esac

unset tunnel
</code></pre>

<p>in your .bashrc or .zshrc file:</p>

<pre><code class="language-bash">alias vpon='sudo ~/.bin/vpn.sh on'
alias vpoff='sudo ~/.bin/vpn.sh off'
</code></pre>

<p>then, you can type <code>vpon</code> to turn on the VPN, and <code>vpoff</code> to shutdown.</p>

<p>references:</p>

<ul>
<li><a href="https://wiki.archlinux.org/index.php/PPTP_VPN_client_setup_with_pptpclient">PPTP VPN client setup with pptpclient</a></li>
</ul>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/setup_my_vim_environment/">
            SETUP MY VIM ENVIRONMENT
          </a>
        </h1>

        <span class="post-date">Sat, Nov 8, 2014</span>

        

<p>It is the Vim that bring we into the marvelous OSS world. Fiddling with it is
full of surprise and happy.</p>

<p>Below records my steps of setting up my Vim environment after every system
re-installation.</p>

<h1 id="toc_0">Installing Vim</h1>

<p>my vim config have be tested on:</p>

<ul>
<li><p>Windows XP and above.</p></li>

<li><p>Mac OSX 10.9 and above using <a href="https://github.com/b4winckler/macvim">MacVim</a>.</p></li>

<li><p>Arch Linux.</p></li>
</ul>

<p><strong>NOTE</strong>: currently I prefer to GUI version than terminal version, hence most
of my configurations are tailored to GUI environments.</p>

<h1 id="toc_1">Setup My Vim-Config Repo</h1>

<p>First pull down my <a href="https://github.com/Mudox/vim-config">vim-config</a> repo from github.</p>

<p>Then create a directory named <em>neobundle</em> under the pulled down repo, which
will holds almost all vim plugins that will be synced by <a href="https://github.com/Shougo/neobundle.vim">neobundle</a>
later.</p>

<p>Create the initial <em>cur_mode</em> file under <em>.vim/chameleon/</em>, which always stores
the chameleon mode of next vim session.</p>

<pre><code class="language-bash"># On Widnows, Must Be Put In C:/Documents And Settings/&lt;User Name&gt;/Vimfiles
git clone https://github.com/Mudox/vim-config.git ~/.vim

cd .vim
mkdir neobundle

cd chameleon
echo 'all' &gt; cur_mode
</code></pre>

<h1 id="toc_2">Install Prerequisites Vim Plugins</h1>

<h2 id="toc_3">Install <a href="https://github.com/Mudox/vim-chameleon">vim-chameleon</a></h2>

<p><a href="https://github.com/Mudox/vim-chameleon">vim-chameleon</a> is my own plugin for managing massive and ever
growing vim &amp; vim plugin configurations.</p>

<pre><code class="language-bash">cd ~/.vim/neobundle
# NOTE: The Renaming Is Important
git clone https://github.com/Mudox/vim-chameleon chameleon
</code></pre>

<h2 id="toc_4">Install <a href="https://github.com/Shougo/neobundle.vim">neobundle</a>.</h2>

<p><a href="https://github.com/Shougo/neobundle.vim">neobundle</a> is a sophisticated vim plugin manager that I have been
using for a long time.</p>

<pre><code class="language-bash">cd ~/.vim/neobundle
# NOTE: The Renaming Is Important
git clone https://github.com/Shougo/neobundle.vim neobundle
</code></pre>

<h2 id="toc_5">Install &amp; compile <a href="https://github.com/Shougo/vimproc.vim">vimproc</a>.</h2>

<p><a href="https://github.com/Shougo/vimproc.vim">vimproc</a> is another plugin written by <a href="https://github.com/Shougo">Shougo</a> that is very
useful, and is required by <a href="https://github.com/Shougo/neobundle.vim">neobundle</a>. The point is that you need to
compile it to get a dynamic library after pulling down its&rsquo; repo.</p>

<pre><code class="language-bash">cd ~/.vim/neobundle
# NOTE: The Renaming Is Important
git clone https://github.com/Shougo/vimproc.vim vimproc

cd vimproc
make # see vimproc/README.md for compilation commands for various platforms.
</code></pre>

<h2 id="toc_6">Run vim to see all other 140+ plugins get installed.</h2>

<p>You can run vim in terminals or open gVim. Better run vim in terminal to watch
the plugins installing progress and spot any errors clearly.</p>

<h1 id="toc_7">Vim Environment For Specific Use Case</h1>

<h2 id="toc_8">Web Developing</h2>

<p>Node.js (and NPM which comes with it) is the essentials of everything below.</p>

<h3 id="toc_9">HTML</h3>

<h3 id="toc_10">JavaScript</h3>

<p>I use:</p>

<ul>
<li><p><a href="https://github.com/jshint/jshint">jshint</a> &amp;
<a href="https://github.com/eslint/eslint">eshint</a> &amp;
<a href="https://github.com/douglascrockford/JSLint.git">jslint</a> for <a href="https://github.com/scrooloose/syntastic">syntastic</a>
checkers.</p></li>

<li><p><a href="https://github.com/beautify-web/js-beautify">js-beautify</a> to prettify
JavaScript code.</p></li>
</ul>

<pre><code class="language-bash">npm install jshint -g
npm install jslint -g
npm install eslint -g
npm install js-beautify -g
</code></pre>

<h3 id="toc_11">CSS</h3>

<p>I use:</p>

<ul>
<li><p><a href="https://github.com/CSSLint/csslint">csslint</a> for <a href="https://github.com/scrooloose/syntastic">syntastic</a> checkers.</p></li>

<li><p><a href="https://github.com/csscomb/csscomb.js">csscomb.js</a> for CSS code prettifier.</p></li>
</ul>

<pre><code class="language-bash">npm intall csslint -g
npm install csscomb -g
</code></pre>

<h2 id="toc_12">Python Scripting</h2>

<h2 id="toc_13">Lua Scripting</h2>

<h2 id="toc_14">Go Scripting</h2>

<h2 id="toc_15">C/C++ Coding</h2>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/error_collection_bash/">
            ERROR COLLECTION - BASH
          </a>
        </h1>

        <span class="post-date">Fri, Nov 7, 2014</span>

        <p>Errors that I collected day by day, when writing the Bash scripting language.</p>

<ul>
<li>Body of <code>select</code> constructs need a <code>break;</code> to quit the selection loop.</li>
</ul>

<pre><code class="language-bash">select answer in #choices#; do
  #body#
  break; # &lt;- go out of selection loop.
done
</code></pre>

<ul>
<li><p>Always <code>source</code> before testing a updated command.</p></li>

<li><p>Whence quoted with <code>&quot;</code>, which is the most case, use the <code>@</code> form (i.e.
<code>&quot;${ARRAY[@]}&quot;</code>) to expand a array correctly. The <code>*</code> form will make the
expanded string as a <strong>single word</strong>.</p></li>

<li><p>The <code>local path</code> is the source of all evil. It will shaddow the global <code>path</code>
where binary search paths is hold in zsh.</p></li>

<li><p>No need to <code>&quot;</code> quote variable that expand to a number in <code>$(( ))</code>, which need
a real number.</p></li>
</ul>

<pre><code class="language-bash">index=$(( RANDOM % &quot;${#array[@]}&quot; )) # no need to double quote '${array[@]}' here
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/error_collection_javascript/">
            ERROR COLLECTION - JAVASCRIPT
          </a>
        </h1>

        <span class="post-date">Fri, Nov 7, 2014</span>

        <p>Errors that I collected day by day when writing the JavaScript language.</p>

<ul>
<li>when assign a function to a event property, dot not appending <code>()</code> to the function name.</li>
</ul>

<pre><code class="language-javascript">window.onload = init/*()*/

function init() {
  // ...
}
</code></pre>

<ul>
<li>appending <code>()</code> to a property name.</li>
</ul>

<pre><code class="language-javascript">var x = Math.floor(Math.random() * canvas.width/*()*/
</code></pre>

<ul>
<li><code>$(this)</code> not <code>$(&quot;this&quot;)</code>.</li>
</ul>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/error_collection_sh/">
            ERROR COLLECTION - BASH
          </a>
        </h1>

        <span class="post-date">Fri, Nov 7, 2014</span>

        <p>Errors that I collected day by day, when writing the Bash scripting language.</p>

<ul>
<li>Body of <code>select</code> constructs need a <code>break;</code> to quit the selection loop.</li>
</ul>

<pre><code class="language-bash">select answer in #choices#; do
  #body#
  break; # &lt;- go out of selection loop.
done
</code></pre>

<ul>
<li><p>Always <code>source</code> before testing a updated command.</p></li>

<li><p>Whence quoted with <code>&quot;</code>, which is the most case, use the <code>@</code> form (i.e.
<code>&quot;${ARRAY[@]}&quot;</code>) to expand a array correctly. The <code>*</code> form will make the
expanded string as a <strong>single word</strong>.</p></li>
</ul>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/setup_my_zsh_environment/">
            SETUP MY ZSH ENVIRONMENT
          </a>
        </h1>

        <span class="post-date">Wed, Nov 5, 2014</span>

        

<p>Steps of setting up zsh environment on my systems (Arch Linux, MacOS,
Windows/Cygwin).</p>

<h2 id="toc_0">the <code>z</code> command</h2>

<h2 id="toc_1">the <code>fzf</code> command</h2>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/setup_my_aweseome_wm_environment/">
            SETUP MY AWESOME WM ENVIRONMENT
          </a>
        </h1>

        <span class="post-date">Wed, Nov 5, 2014</span>

        

<p>Awesome WM let you maniplate system windows like using Vim, besides its
bleeding fast window UI rendering &amp; switching speed on *nix platform I&rsquo;ve ever
seen.</p>

<p>Below records my steps of setting up the Awesome window manager on my Arch
Linux progressively.</p>

<h1 id="toc_0">Installing Awesome Packages</h1>

<p>The awesome package is in the official repository of Arch Linux.</p>

<p>Better install Xephyr for testing cases.</p>

<pre><code class="language-bash">sudo pacman -S awesome xorg-xephyr
</code></pre>

<h1 id="toc_1">Pulling Down My Awesome-Config Repository</h1>

<p>The pulled down repo must be put in ~/.config/awesome, where awesome will
correctly load the configuration resources.</p>

<pre><code class="language-bash">mkdir ~/.config # if .config does not exist before.
cd ~/.config
git clone https://github.com/Mudox/awesome-config.git awesome
cd awesome
git submodule update --init --recursive
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/setup_my_cygwin_environment/">
            SETUP MY CYGWIN ENVIRONMENT
          </a>
        </h1>

        <span class="post-date">Wed, Nov 5, 2014</span>

        

<p>Cygwin &ndash; bring *nix command line user experence (paritially though) and
efficiency onto Windows.
Below is the steps of setting up the Cygwin environment on my Windows.</p>

<h1 id="toc_0">Why Cygwin over other tools.</h1>

<h1 id="toc_1">Setup Cygwin</h1>

<h2 id="toc_2">Cygwin path remapping</h2>

<h2 id="toc_3">mintty setting</h2>

<h2 id="toc_4">color</h2>

<h3 id="toc_5">mintty color palette</h3>

<h3 id="toc_6">ls_color</h3>

<h3 id="toc_7">colorful manpage</h3>

<h3 id="toc_8">colout</h3>

<h2 id="toc_9">encoding</h2>

<h2 id="toc_10">other settings</h2>

<h2 id="toc_11">Shell environment setup</h2>

<h2 id="toc_12">Cygwin package manager</h2>

<h1 id="toc_13">Cygwin Using Tips</h1>

<h2 id="toc_14">Working with gVim of Windows</h2>

<p>Most of the time, I prefer gui version of Vim than terminal version for it
being free of various shackles of terminal emulator, such as key confliction,
color presentation limit, UI rendering efficiency limit, etc.</p>

<p>First make sure a gVim instance already exists outside of Cygwin.</p>

<p>When I need to handle off some files to gVim for Windows, I can use <code>--remote</code>
(type <code>:h clientserver</code> in gVim for details) command families, for example:</p>

<pre><code class="language-bash">alias gvim='/c/Program Files/Vim/vim74/gvim.exe'

gvim --remote-tab /path/of/file
</code></pre>

<p>it will open the file in new tab of an already running gVim instance.</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/post/about_the_site/">
            ABOUT THE SITE
          </a>
        </h1>

        <span class="post-date">Wed, Nov 5, 2014</span>

        

<h1 id="toc_0">Note To Myself</h1>

<h2 id="toc_1">When to use</h2>

<h3 id="toc_2">&lt;code&gt;</h3>

<ul>
<li><p>in-line command line.</p></li>

<li><p>command name</p></li>

<li><p>package / software / application name offen appears in script code</p></li>

<li><p>file path</p></li>
</ul>

<h3 id="toc_3">&lt;strong&gt;</h3>

<ul>
<li>single word or words that should be prominent in a sentence.</li>
</ul>

<h3 id="toc_4">&lt;em&gt;</h3>

<h2 id="toc_5">To-Do List of the Site</h2>

<ul>
<li><p>plural view customization.</p></li>

<li><p>list of content in sidebar for article single view.</p></li>

<li><p>top menu item more fancier.</p></li>

<li><p>tidy up CSS file.</p></li>

<li><p>term list view pagination.</p></li>

<li><p>home page.</p></li>

<li><p>add summary to each article.</p></li>

<li><p>chinese version of the site.</p></li>

<li><p>translation posts.</p></li>
</ul>

<h1 id="toc_6">Acknowledgements</h1>

<h2 id="toc_7"><a href="http://gohugo.io/">Hugo</a></h2>

<blockquote>
<p>A Fast and Flexible Static Site Generator built with love by spf13 in GoLang.</p>
</blockquote>

<h2 id="toc_8"><a href="https://github.com/spf13/hyde.git">Hyde</a></h2>

<blockquote>
<p>Hyde is a brazen two-column hugo theme based on the Jekyll theme of the same
name. It pairs a prominent sidebar with uncomplicated content.</p>
</blockquote>

<h2 id="toc_9"><a href="http://jquery.com/">JQuery</a></h2>

<blockquote>
<p>jQuery is a fast, small, and feature-rich JavaScript library. It makes things
like HTML document traversal and manipulation, event handling, animation, and
Ajax much simpler with an easy-to-use API that works across a multitude of
browsers. With a combination of versatility and extensibility, jQuery has
changed the way that millions of people write JavaScript.</p>
</blockquote>

<h2 id="toc_10"><a href="https://github.com/isagalaev/highlight.js.git">Highlight.js</a></h2>

<blockquote>
<p>Highlight.js is a syntax highlighter written in JavaScript. It works in the
browser as well as on the server. It works with pretty much any markup,
doesn&rsquo;t depend on any framework and has automatic language detection.</p>
</blockquote>

<h2 id="toc_11"><a href="http://www.nodejs.org/">Node.js</a></h2>

<blockquote>
<p>Node.js® is a platform built on Chrome&rsquo;s JavaScript runtime for easily
building fast, scalable network applications. Node.js uses an event-driven,
non-blocking I/O model that makes it lightweight and efficient, perfect for
data-intensive real-time applications that run across distributed devices.</p>
</blockquote>

<h2 id="toc_12"><a href="http://bower.io/">Bower</a></h2>

<blockquote>
<p>A package manager for the web.</p>

<p>Bower works by fetching and installing packages from all over, taking care of
hunting, finding, downloading, and saving the stuff you’re looking for. Bower
keeps track of these packages in a manifest file, bower.json. How you use
packages is up to you. Bower provides hooks to facilitate using packages in
your tools and workflows.</p>
</blockquote>

<h2 id="toc_13"><a href="http://www.goat1000.com/tagcanvas.php">TagCanvas</a></h2>

<blockquote>
<p>TagCanvas is a Javascript class which will draw and animate a HTML5 canvas
based tag cloud.</p>
</blockquote>

<h2 id="toc_14"><a href="https://github.com/VincentGarreau/particles.js">particles.js</a></h2>

<blockquote>
<p>A lightweight JavaScript library for creating particles.</p>
</blockquote>

<h2 id="toc_15"><a href="https://github.com/necolas/normalize.css">normalize.css</a></h2>

<blockquote>
<p>A collection of HTML element and attribute style-normalizations.</p>
</blockquote>

<h2 id="toc_16"><a href="https://github.com/ramswaroop/animatescroll.js">animatescroll.js</a></h2>

<blockquote>
<p>A Simple jQuery Plugin for Animating Scroll</p>
</blockquote>

<h2 id="toc_17"><a href="https://github.com/daneden/animate.css">animate.css</a></h2>

<blockquote>
<p>A cross-browser library of CSS animations. As easy to use as an easy thing.
<a href="http://daneden.github.io/animate.css">http://daneden.github.io/animate.css</a></p>
</blockquote>

<h2 id="toc_18"><a href="https://github.com/hakimel/stroll.js">stroll.js</a></h2>

<blockquote>
<p>CSS3 list scroll effects <a href="http://lab.hakim.se/scroll-effects">http://lab.hakim.se/scroll-effects</a></p>
</blockquote>

<h2 id="toc_19"><a href="https://github.com/knsv/mermaid.git">mermaid.js</a></h2>

<blockquote>
<p>Generation of diagrams and flowcharts from text in a similar manner as
markdown.</p>
</blockquote>

<h2 id="toc_20"><a href="https://github.com/mbostock/d3">D3.js</a></h2>

<blockquote>
<p>D3.js is a JavaScript library for manipulating documents based on data. D3
helps you bring data to life using HTML, SVG and CSS. D3’s emphasis on web
standards gives you the full capabilities of modern browsers without tying
yourself to a proprietary framework, combining powerful visualization
components and a data-driven approach to DOM manipulation.</p>
</blockquote>

<h2 id="toc_21"><a href="http://www.vim.org">gVim</a></h2>

<blockquote>
<p>the editor.</p>
</blockquote>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/my_vim_customization_policy/">
            MY VIM CUSTOMIZATION POLICY
          </a>
        </h1>

        <span class="post-date">Thu, Oct 30, 2014</span>

        

<p>It is the Vim that bring we into the fantastic OSS world. Fiddling with it is
full of surprise and happy.</p>

<p>Below records my thoughts and rules of customizing my Vim.</p>

<h1 id="toc_0">About Mapping</h1>

<h2 id="toc_1">Good prefixes for normal mode mappings</h2>

<h3 id="toc_2">The comma <code>,</code></h3>

<p>use 2 ~ 3 suffix characters, then we can get more candidates key combinations
for mapping.</p>

<h3 id="toc_3">The backslash <code>\</code></h3>

<p>different keyboard layouts have different locations for <code>\</code>, so it should be
used less frequently than <code>,</code>.</p>

<h3 id="toc_4">The space key <code>&lt;Space&gt;</code></h3>

<p>the <code>&lt;Space&gt;</code> is the best prefix for normal mappings I&rsquo;ve ever found. It spans
a long distance at the bottom of the keyboard, which makes it&rsquo;s very easy and
comfortable to touch.</p>

<p>currrently, I only assigned it to</p>

<ul>
<li><p><a href="https://github.com/kien/ctrlp.vim.git">kien&rsquo;s &lsquo;CtrlP&rsquo;</a> family mappings</p></li>

<li><p><a href="https://github.com/Mudox/vim-omnimenu">my &lsquo;vim-omnimenu&rsquo;</a> mappings</p></li>

<li><p><a href="https://github.com/Mudox/vim-chameleon">my &lsquo;vim-chameleon&rsquo;</a> mappings</p></li>
</ul>

<h3 id="toc_5">The enter <code>&lt;Cr&gt;</code> or <code>&lt;Enter&gt;</code></h3>

<p>since many vim itself and many plugin use <Cr>, so I should use it sparely.
when a single click of <Cr> is needed, you will feel a noticeable response lag.</p>

<h3 id="toc_6">The backspace key <code>&lt;BS&gt;</code></h3>

<p>by default, the <code>&lt;BS&gt;</code> acts the same as <code>h</code>, <code>Ctrl-H</code> and <code>&lt;Left&gt;</code> keys on
normal mode. so I have substituted it with the <code>&lt;Enter&gt;</code> key as a main prefix.</p>

<h3 id="toc_7">other possible key for prefixes</h3>

<ul>
<li><p><code>&lt;C-P&gt;</code></p></li>

<li><p><code>&lt;C-N&gt;</code></p></li>

<li><p><code>=</code></p></li>
</ul>

<h2 id="toc_8">Mapping toggling commands</h2>

<ol>
<li><p>use <code>co</code> prefix, which is derived from <a href="https://github.com/tpope/vim-unimpaired.git">tpope&rsquo;s &lsquo;unimpaired&rsquo;</a> plugin.</p></li>

<li><p>use <code>,*&lt;Space&gt;</code> pattern, which is derived from <a href="https://github.com/scrooloose/nerdcommenter.git">scrooloose&rsquo;s &lsquo;NERD commenter&rsquo;</a> plugin.</p></li>
</ol>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/swift_oo/">
            SWIFT OJECT-ORIENTED FEATURE
          </a>
        </h1>

        <span class="post-date">Wed, Oct 29, 2014</span>

        

<p>Learning notes about object oriented features of the Swift programming
language.</p>

<h1 id="toc_0">Class Like Constructs In Swift</h1>

<p>In Swift, <code>enum</code>, <code>struct</code>, <code>class</code> all can:</p>

<ol>
<li><p>have <strong>properties</strong> to keep states.</p></li>

<li><p>have <strong>methods</strong> to perform actions.</p></li>

<li><p>define <strong>subscript</strong> operators to let user access their properties through
subscript syntax.</p></li>

<li><p>define <strong>initializers</strong> to have a reasonable initial state.</p></li>

<li><p>be <strong>extended</strong> to have additional behaviors beyond their default implementations.</p></li>

<li><p>conform to <strong>protocols</strong>.</p></li>
</ol>

<p>Only <code>class</code> can:</p>

<ol>
<li><p>have <strong>inheritance</strong> capability.</p></li>

<li><p>have <strong>deinitializer</strong>.</p></li>

<li><p>be <strong>referenced</strong> by mutiple variable or constants. the <code>struct</code> and <code>enum</code>
are both value types.</p></li>
</ol>

<h1 id="toc_1">Properties</h1>

<h2 id="toc_2">stored properties</h2>

<h3 id="toc_3">lazy properties</h3>

<h2 id="toc_4">computed properties</h2>

<h3 id="toc_5">shorthand setter syntax</h3>

<h3 id="toc_6">shorthand read-only getter syntax</h3>

<h1 id="toc_7">Initializers</h1>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/javascript_type_conversions/">
            JAVASCRIPT TYPE CONVERSIONS
          </a>
        </h1>

        <span class="post-date">Tue, Oct 28, 2014</span>

        

<p>Here records what I learned about JavaScript&rsquo;s type conversion.</p>

<h1 id="toc_0">Sepcial Value Or Types In JavaScript</h1>

<h2 id="toc_1">The <code>undefined</code></h2>

<p>The <code>undefined</code> is the only value of <code>undefined</code>, represents unknown value of any
other types, including primitive types &amp; object.</p>

<pre><code class="language-js">// play with 'undefined'
typeof undefiend                  /* undfeined        */
undefined == undefined            /* true             */
undefined == null                 /* true             */
undefined !== null                /* true             */
Boolean(undefined)                /* false            */
Number(undefined)                 /* NaN              */
</code></pre>

<h2 id="toc_2">The <code>null</code></h2>

<p>The <code>null</code>, by standards, should be the only value of <code>null</code> type, but in certain
browser (e.g. firfox, chrome), it is of type <code>object</code>. <code>null</code> is used to
represent unknown value of an object.</p>

<p>It is equal to itself and it is equal to <code>undefined</code>.</p>

<pre><code class="language-js">// play with 'null'
typeof null                       /* object           */
null == null                      /* true             */
null == undefined                 /* true             */
null !== undefined                /* true             */
Boolean(null)                     /* false            */
Number(null)                      /* 0                */
</code></pre>

<h2 id="toc_3">The <code>NaN</code></h2>

<p>The <code>NaN</code> is a <code>Number</code> that can not be represented as a number.</p>

<p>It dose <strong>NOT</strong> equal to itself, hence JavaScript provide a built-in function
<code>isNaN()</code> to test if a value is a NaN.</p>

<pre><code class="language-javascri">// play with 'NaN'
typeof NaN                        /* number           */
NaN == NaN                        /* false            */
NaN == undefined                  /* false            */
NaN == null                       /* false            */
Boolean(NaN)                      /* false            */
Number(NaN)                       /* NaN              */
isNaN(NaN)                        /* true             */
NaN == 0/0                        /* true             */
isNaN(0/0)                        /* true             */
</code></pre>

<h1 id="toc_4">Implicit Type Conversions</h1>

<h2 id="toc_5">When other types need to be converted into a number</h2>

<p>When different types are mixed in a relational operation (i.e <code>== != &lt; &lt;= &gt;
&gt;=</code>) except the <code>===</code> operator, or an arithmetic operation, except
the <code>+</code> operator, they would be converted into numbers first.</p>

<h3 id="toc_6">For Boolean:</h3>

<ul>
<li><p>true would be converted to 1</p></li>

<li><p>false would be converted to 0</p></li>
</ul>

<h3 id="toc_7">For String:</h3>

<p>It is converted literally, i.e.</p>

<pre><code class="language-js">'2014' &lt; 2 /* 2014 &lt; 2 yields false */
'3.1415' == 3.1415 /* 3.1415 == 3.1415 yields true */
</code></pre>

<p>There is one exception: a <code>emtpy</code> string would be converted to 0.</p>

<pre><code class="language-js">var emptyText = '';

/* 'emptyText' here, converetd to 0, is compared to true which is converted to 1,
and then '!' negates the results to true */
if (!emptyText) {
  console.log('empty text is not true!')
}
</code></pre>

<h2 id="toc_8">When other types need to be converted into a string</h2>

<h3 id="toc_9">The special <code>+</code> operator</h3>

<p>In JavaScript, the <code>+</code> is first a string concatenation operator, then a
arithmetic addition operator.</p>

<p>When one of <code>+</code>&rsquo;s operands is a string, JavaScript will try to convert the
other operand into a string, and perform a concatenation operation.</p>

<h3 id="toc_10">For Boolean:</h3>

<ul>
<li><p><code>true</code> would be conveted bo &ldquo;true&rdquo;</p></li>

<li><p><code>false</code> would be conveted to &ldquo;false&rdquo;</p></li>
</ul>

<h3 id="toc_11">For <code>null</code>, <code>undefined</code> &amp; <code>NaN</code></h3>

<p>they all be converted literally.</p>

<h2 id="toc_12">When other types need to be converted into a boolean value</h2>

<p>from 《Head First JavaScript Programming》:</p>

<blockquote>
<p>the secret to learning what is truthy and what is falsey is to learn what’s
falsey, and then consider everything else truthy.
concentrate on  knowing what is falsey, and then everything else you can
consider truthy.</p>
</blockquote>

<p>it is a golden rule that also applys in many other programming language
learning situations.</p>

<p>As to what value should be considered as falsey, different language has
different policy. There are <strong>5</strong> falsey value in JavaScript:</p>

<ol>
<li><p><code>undefined</code></p></li>

<li><p><code>null</code></p></li>

<li><p><code>NaN</code></p></li>

<li><p><code>&quot;&quot;</code></p></li>

<li><p><code>0</code></p></li>
</ol>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/web_page_layouts/">
            WEB PAGE LAYOUTS
          </a>
        </h1>

        <span class="post-date">Sun, Oct 26, 2014</span>

        

<h1 id="toc_0">Liquid Layout</h1>

<p>This is the browser&rsquo;s default layout behavior, if you did not add any CSS to
style a page. The block elements, like liquid, just fill as much space as they
can in the pages.</p>

<h1 id="toc_1">Frozen Layout</h1>

<p>By using the CSS attribute combination of <code>float</code> and <code>width</code>, we can put a
<strong>containing</strong> block (i.e. <code>&lt;seciton&gt;</code>, <code>&lt;aside&gt;</code>, <code>&lt;div&gt;</code>) to float on to
left-most or right-most side forming a <strong>column</strong>, and let the  remaining
content to flow around the fixed-width floating column, forming the other
column.</p>

<p>Use CSS attribute <code>clear: [left | right]</code> to let a block to layout fully
underneath a floating elements.</p>

<h1 id="toc_2">Jello Layout</h1>

<p>On the basis of frozen layout, we can use containing fixed-width block to wrap
all columns (floating or flowing), and by using <code>margin-left: auto;
margin-right: auto;</code> CSS style, to center the contained columns in the page.</p>

<h1 id="toc_3">Absolute Position</h1>

<p>By using the CSS attribute combination of <code>position: [absolute | fixed]</code> and
<code>left | right | top | bottom: ...</code>, we can take the column fully out of layout
flow, and fix their position relative to the page (<code>position: absolute</code>), or to
the viewport (<code>position: fixed</code>).</p>

<h1 id="toc_4">Table Display</h1>

<p>Use CSS attribute <code>display: [table | table-row | table-cell]</code> to organize HTML
elements into an invisible table.</p>

<p>Most of the time, <code>vertical-align: top</code> will help you to get what you want to see.</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/swift_features/">
            SWIFT FEATURES
          </a>
        </h1>

        <span class="post-date">Tue, Oct 14, 2014</span>

        

<p>During the learning of the Swift programming language, many of it&rsquo;s features
impressed me.</p>

<h1 id="toc_0">Powerful <code>switch</code> Statement</h1>

<ol>
<li><p>no implicitly fall-through</p></li>

<li><p>match multiple conditions in one case statement.</p></li>

<li><p>match against range.</p></li>

<li><p>match against tuple.</p></li>

<li><p>value binding.</p></li>

<li><p><code>where</code> clause can provide more conditions.</p></li>

<li><p><code>break</code> &amp; <code>continue</code> can <em>jump</em> further (to some label)</p></li>
</ol>

<pre><code class="language-swift">var aPoint = (x: 2, y: -1)
// labeled `swtich`
// NOTE: only loop statements and 'switch' statement can labeled.
theSwitch: switch aPoint {
// against tuple
case (0, 0):
  println(&quot;origin point&quot;)

// against multiple conditions separated by comma
case (1, 1), (2, 2):
  println(&quot;(1, 1) or (2, 2)&quot;)

// '_' means 'any value is ok'
case (_, 0):
  // the `break` here is just like the `pass` in python, acting as a
  // 'placeholder statement', nullifing this case branch.
  break

case (0, _):
  println(&quot;on the Y-axis&quot;)

// against range
case (-2...2, -2...2):
  println(&quot;on or in the 2x2 box&quot;)

// value binding
case (let x, -10):
  println(&quot;on the horizontal line y = -10, with a x value: \(x)&quot;)

// where clause
// NOTE: `let` can be replaced with `var` if you need to change the bound
// value afterwards.
case (0, var y) where y &gt;= 0:
  y++    // mutable
  println(&quot;on the 1st or 2nd quadrant&quot;)

// value binding as a whole, which is an required exhaustive match
case let (x, y):
  theLoop: for i in 1..&lt;100 {
    switch i {
      case let x where (x &amp; 1) == 1: // a odd number
        break theSwitch     // jump further
      default:
        continue theLoop    // jump
    }
  }
}
</code></pre>

<h1 id="toc_1">Closure &ndash; Too Much Sugar!</h1>

<p>The closure in Swift language adopts many syntactic sugar.</p>

<p>The basic full syntax of a closure is as follows:</p>

<pre><code class="language-swift">{
  (parameters) -&gt; retrunType in
  ... statements ...
}
</code></pre>

<p>Here is an example that uses the array&rsquo;s method <code>sorted</code> to sort an array of word.</p>

<pre><code class="language-swift">var words = [ &quot;Dolor&quot;, &quot;eum&quot;, &quot;id&quot;, &quot;suscipit&quot;, &quot;necessitatibus&quot;, &quot;quod&quot;, &quot;hic&quot;, &quot;dignissimos&quot; ]

let sortedWords = words.sorted({
  (lhs: String, rhs: String) -&gt; Bool in
  return lhs &lt; rhs
})
</code></pre>

<h2 id="toc_2">Sugar #0 &ndash; trailing closure</h2>

<p>Often, closure parameter is placed last in parameter list. Swift thus provides
<strong>trailing closure</strong>, which means your can write the inline closure just
outside the parameter list, following the closing <code>)</code>.</p>

<p>Furthermore, if the closure is the only parameter, then the parenthesis can be
omitted.</p>

<pre><code class="language-swift">// trailing closure
let sortedWords = words.sorted/*()*/ {
  (lhs: String, rhs: String) -&gt; Bool in
  return lhs &lt; rhs
}
</code></pre>

<h2 id="toc_3">Sugar #1 &ndash; return type inference</h2>

<p><strong>return type</strong> can be inferred by swift compiler.</p>

<pre><code class="language-swift">// omit return type
let sortedWords = words.sorted {
  (lhs: String, rhs: String) /*-&gt; Bool*/ in
  return lhs &lt; rhs
}
</code></pre>

<h2 id="toc_4">Sugar #2 &ndash; parameter type inference</h2>

<p><strong>parameter types</strong> can be inferred by swift compiler as well.</p>

<pre><code class="language-swift">// omit parameter types
let sortedWords = words.sorted {
  (lhs/*: String*/, rhs/*: String*/) /*-&gt; Bool*/ in
  return lhs &lt; rhs
}
</code></pre>

<h2 id="toc_5">Sugar #3 &ndash; parenthesis-less</h2>

<p>Since no type annotation is needed, the <strong>parenthesis</strong> can be omitted.</p>

<pre><code class="language-swift">// omit parenthesis
let sortedWords = words.sorted {
  /*(*/lhs/*: String*/, rhs/*: String)*/ /*-&gt; Bool*/ in
  return lhs &lt; rhs
}
</code></pre>

<h2 id="toc_6">Sugar #4 &ndash; return statement inference</h2>

<p>If the closure has one statement, then the <strong>return</strong> statement can also be
inferred.</p>

<pre><code class="language-swift">// omit 'return'
let sortedWords = words.sorted {
  /*(*/lhs/*: String*/, rhs/*: String)*/ /*-&gt; Bool*/ in
  /*return*/ lhs &lt; rhs
}

//then we got:
let sortedWords = words.sorted { lhs, rhs in lhs &lt; rhs }
</code></pre>

<h2 id="toc_7">Sugar #5 &ndash; shorthand parameter name</h2>

<p>Swift provides <strong>shorthand parameter names</strong>: $0 for the 1st parameter, $1 for
the 2nd parameter, and so on. And as an side effect, the whole <code>(parameters) -&gt;
returType in</code> statement can be completely omitted</p>

<pre><code class="language-swift">// use shorthand parameters, omit the whole 'in' statement
let sortedWords = words.sorted {
  /*(lhs: String, rhs: String) -&gt; Bool in*/
  /*return*/ $0 &lt; $1
}

// then we got:
let sortedWords = words.sorted { $0 &lt; $1 }
</code></pre>

<h2 id="toc_8">Sugar #6 &ndash; operator as a closure</h2>

<p>In swift, <strong>operator</strong> is a function, which in turn is a special closure, so&hellip;</p>

<pre><code class="language-swift">// comes operator!
let sortedWords = words.sorted(&lt;)
</code></pre>

<h1 id="toc_9">Fully-fledged Enumeration</h1>

<p>In Swift, enumeration is fully-fledged type. You can associate different data
with each enumeration member, or define a raw type for enumeration.</p>

<h2 id="toc_10">Flexible definition syntax</h2>

<p>you can define more than one member a line.</p>

<h2 id="toc_11">Type inference</h2>

<h2 id="toc_12">Associated Value</h2>

<h2 id="toc_13">Raw type</h2>

<h2 id="toc_14">Struct like enumeration</h2>

<p>enumeration in Swift can have properties &amp; methods.</p>

<p>enumeration, like struct in Swift, is value type (while class is reference
accounted type).</p>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/post/about_me/">
            ABOUT ME
          </a>
        </h1>

        <span class="post-date">Thu, Oct 2, 2014</span>

        <p>Hi, I&rsquo;m Mudox.</p>

<p>I am also in:</p>

<ul>
<li><p><a href="https://github.com/Mudox">github.com/Mudox</a></p></li>

<li><p><a href="http://my.oschina.net/mudox">oschina.net/mudox</a></p></li>
</ul>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/git/">
            GIT MISC
          </a>
        </h1>

        <span class="post-date">Thu, Oct 2, 2014</span>

        

<h1 id="toc_0">Alias</h1>

<ul>
<li><p>working tree, working directory</p></li>

<li><p>index, staging area, cache, staged snapshot</p></li>

<li><p>commit[ted] history, commit[ted] snapshot</p></li>
</ul>

<h1 id="toc_1">The <code>add</code> &amp; <code>rm</code> &amp; <code>reset</code> &amp; <code>commit</code> &amp; <code>checkout</code> Sub-commands.</h1>

<ul>
<li><p>between the <em>committed history</em> &amp; <em>staging area</em></p>

<ul>
<li><p><code>commit</code> submit changes from <em>staging area</em> to <em>committed history</em></p></li>

<li><p><code>reset</code> revert changes from <em>committed history</em> back to <em>staging area</em></p></li>
</ul></li>

<li><p>between the <em>staging area</em> &amp; <em>working tree</em>.</p>

<ul>
<li><p><code>add</code> submit changes from <em>working tree</em> to <em>staging area</em>, preparing
for committing.</p></li>

<li><p><code>rm</code> remove file(s) from <em>stageing area</em>, so they become <em>untracked</em>.</p></li>
</ul></li>

<li><p><code>checkout</code> restore changes from staging area or a specific commit of committed
history to <em>working directory</em>.</p></li>

<li><p><code>reset</code></p>

<ul>
<li><p><strong>unstages</strong> changes in staging area.
v
    git reset <paths></p></li>

<li><p>or, if you ask for more, <strong>uncommits</strong> changes in history.</p>

<pre><code>git reset &lt;commit-ish&gt;
</code></pre></li>
</ul></li>

<li><p><code>rm</code></p>

<ul>
<li><p><strong>untracks</strong> file(s) previously tracked in staging area.</p>

<pre><code>git rm --cache &lt;paths&gt;
</code></pre></li>

<li><p>or, if you ask for more, <strong>removes</strong> file(s) in the work directory.</p>

<pre><code>git rm &lt;paths&gt;
</code></pre></li>
</ul></li>

<li><p><code>git reset</code> vs <code>git checkout</code></p>

<ul>
<li><p><code>git reset &lt;commit-ish&gt; &lt;paths&gt;</code> only update <em>staging area</em>.</p></li>

<li><p><code>git checkout &lt;paths&gt;</code> fetch <code>&lt;paths&gt;</code> from <em>staging area</em> to working
direcotry.</p></li>

<li><p><code>git checkout &lt;commit-ish&gt;</code> fetch <code>&lt;paths&gt;</code> from <em>history</em> to both
<em>index</em> &amp; <em>working direcotry</em>.</p></li>
</ul></li>
</ul>

<h1 id="toc_2">The <code>git Rebase</code> Sub-command</h1>

<h2 id="toc_3">Advantage of <code>rebase</code>:</h2>

<ul>
<li><p>no additional merge commit</p></li>

<li><p>linear commit history</p></li>
</ul>

<h2 id="toc_4">Disadvantage of <code>rebase</code>:</h2>

<ul>
<li><p>safety</p></li>

<li><p>tracability: the evidences of merging are wiped away.</p></li>
</ul>

<h2 id="toc_5">Golden rule of <code>git rebase</code>:</h2>

<p><strong>never</strong> use it on <strong>public</strong> branches.</p>

<h2 id="toc_6">When to use <code>rebase</code></h2>

<ul>
<li><p>Local cleanup</p></li>

<li><p>Incorporating upstream changes into a feature branch</p></li>

<li><p>Integrating a approved feature</p></li>
</ul>

<h1 id="toc_7">The <code>reset</code>, <code>checkout</code> And <code>revert</code> Sub-commands</h1>

<blockquote>
<p>The parameters that you pass to <code>git reset</code> and <code>git checkout</code> determine
their scope. When you don’t include a <strong>&lt;file path&gt;</strong> as a parameter, they
operate on whole commits.  Note that git revert has no file-level counterpart</p>
</blockquote>

<p>from <a href="https://www.atlassian.com/git/tutorials/resetting-checking-out-and-reverting/commit-level-operations">atlassian&rsquo;s git tutorials</a></p>

<h2 id="toc_8">Commit level operations</h2>

<p><code>git reset --[soft | mixed | hard] &lt;commit-ish&gt;</code> <strong>move</strong> branch tips backwards
or even forwards, while affecting <em>staging area</em> &amp; <em>working direcotry</em> according to
options it is given.</p>

<table>
<thead>
<tr>
<th>option</th>
<th>history</th>
<th>staging area</th>
<th>working directory</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>--soft</code></td>
<td>√</td>
<td></td>
<td></td>
</tr>

<tr>
<td><code>--mixed</code></td>
<td>√</td>
<td>√</td>
<td></td>
</tr>

<tr>
<td><code>--hard</code></td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
</tbody>
</table>

<p><code>git checkout &lt;commit-ish&gt;</code> dose not move tips around.</p>

<p><code>git revert</code> undo commits by adding a new commit. it is a safe (reversible) way
to undo commits, while <code>git reset</code> is dangerous (irreversible) way to undo
commits.</p>

<h2 id="toc_9">File level operations</h2>

<pre><code>git [reset|checkout] &lt;commit-ish&gt; &lt;pathspec&gt;
</code></pre>

<table>
<thead>
<tr>
<th>command</th>
<th>history</th>
<th>staging area</th>
<th>working directory</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>reset</code></td>
<td></td>
<td>√</td>
<td>√</td>
</tr>

<tr>
<td><code>checkout</code></td>
<td></td>
<td></td>
<td>√</td>
</tr>
</tbody>
</table>

<h1 id="toc_10">Summary</h1>

<table>
<thead>
<tr>
<th>command</th>
<th>commit level</th>
<th>file level</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>reset</code></td>
<td>discard commits in private branches or throw away uncommited changes</td>
<td>unstage a file</td>
</tr>

<tr>
<td><code>checkout</code></td>
<td>swtich between branches or inspect old snapshots</td>
<td>discard changes in the working directory</td>
</tr>

<tr>
<td><code>revert</code></td>
<td>undo commits in public branches</td>
<td><strong>N/A</strong></td>
</tr>
</tbody>
</table>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/compile_macvim_and_ycm_on_osx/">
            COMPILE MACVIM &amp; YCM ON OSX
          </a>
        </h1>

        <span class="post-date">Mon, Sep 29, 2014</span>

        

<p>Compiling <a href="http://valloric.github.io/YouCompleteMe/">Youcompleteme</a> and <a href="https://github.com/b4winckler/macvim">Macvim</a> on MacOSX once beaten me
down for several nights.</p>

<p>I eventually found out that this is because the interference from
<a href="https://github.com/yyuu/pyenv">pyenv</a> and [homebrew][brew].</p>

<p>[homebrew][brew] installs packages into a unconventional path, which makes
MacVim and Youcompleteme can found buidling dependencies in default paths.</p>

<p>While <a href="https://github.com/yyuu/pyenv">pyenv</a> will shadow <a href="https://github.com/b4winckler/macvim">Macvim</a>&rsquo;s default python &hellip;</p>

<h1 id="toc_0">Preparation</h1>

<ul>
<li><p>disable pyenv</p>

<ol>
<li><p>run <code>brew unlink pyenv</code> (<code>brew link pyenv</code> after compilation)</p></li>

<li><p>restart shell (e.g. itemr2)</p></li>
</ol></li>

<li><p>reset develop directory of Xcode</p>

<ol>
<li><code>sudo xcode-select -r</code></li>
</ol></li>
</ul>

<h1 id="toc_1">Compile YCM</h1>

<p>On MacOSX using native clang package has proven to be very stable, besides, it
drastically accelerates the installing process &ndash; leaving <code>install.sh</code> no need
to download the prebuild binaries from LLVM&rsquo;s site.</p>

<pre><code class="language-bash">cd /to/ycm/root/directory/
    ./install.sh --clang-completer --system-libclang
</code></pre>

<h1 id="toc_2">Compile MacVim</h1>

<pre><code class="language-bash">make distclean
./configure               \
    --with-features=huge  \
    -with-macarchs=x86_64 \
    --enable-perlinterp   \
    --enable-rubyinterp   \
    --enable-pythoninterp \
    --enable-luainterp    \
    --enable-perlinterp   \
    --enable-cscope       \
    --with-lua-prefix=/usr/local/Cellar/lua/&lt;current_version&gt; &gt;/tmp/log
make
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/memo/vim_chameleon_startup_menu/">
            VIM CHAMELEON STARTUP MENU
          </a>
        </h1>

        <span class="post-date">Mon, Sep 29, 2014</span>

        

<p>Records here the steps of making a small and neat vim-chameleon startup screen.</p>

<h1 id="toc_0">On Windows:</h1>

<ol>
<li><p>create a shortcut from gVim.exe.</p></li>

<li><p>right click on the shorcut to open it&rsquo;s property dialog.</p></li>

<li><p>append the following lines (<em>concatenated into one line</em>) to the <strong>target</strong> field.</p></li>
</ol>

<pre><code class="language-bash">--cmd &quot;let g:mdx_chameleon_cur_mode = 'startup'&quot;
--cmd &quot;set lines=9 columns=32&quot;
--cmd &quot;winpos 475 320&quot;
-c &quot;let &amp;titlestring='Happy Vimming!'&quot;
-c &quot;ChamStartup&quot;
</code></pre>

<ol>
<li>optionally, put this shortcut under paths listed in system&rsquo;s $PATH environment variable.</li>
</ol>

<h1 id="toc_1">On Mac OSX:</h1>

<p>the <code>MacVim.app</code> does not accepts arguemnts above, we should use:</p>

<pre><code class="language-bash">/Applications/MacVim.app/Contents/MacOS/Vim -g
</code></pre>

<p>instead:</p>

<pre><code class="language-bash">/Applications/MacVim.app/Contents/MacOS/Vim -g            \
        --cmd &quot;let g:mdx_chameleon_cur_mode = 'startup'&quot;  \
        --cmd &quot;set lines=9 columns=22&quot;                    \
        --cmd &quot;winpos 880 370&quot;                            \
        -c &quot;let &amp;titlestring='Happy Vimming!'&quot;            \
        -c &quot;let &amp;guifont = 'Monaco for Powerline:h16'&quot;    \
        -c &quot;ChamStartup&quot;
</code></pre>

<h1 id="toc_2">On Linux:</h1>

<pre><code class="language-bash">
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/git_flow/">
            GIT FLOW
          </a>
        </h1>

        <span class="post-date">Sun, Sep 28, 2014</span>

        

<h1 id="toc_0">1. Main Branches</h1>

<ul>
<li><p>the <code>main</code> branch</p>

<p>keeps the official release history (usually with version nubmer tags
attached).</p>

<p>i.e. every commits in master is a new release. all branches merged back
into master must have a new incremental version number.</p></li>

<li><p>the <code>develop</code> branch</p>

<p>serves as an integration branch for features.</p>

<p>nitghly build built from it.</p></li>
</ul>

<h1 id="toc_1">2. Supporting Branches</h1>

<h2 id="toc_2">2.1 feature (or topic) branches</h2>

<p>branch off from: <code>develop</code> branch</p>

<p>merge into: <code>develop</code> branch</p>

<p>naming convention: any name except <code>master</code>, <code>develop</code>, <code>relase[/-]*</code>,
<code>hotfix[/-]*</code></p>

<pre><code class="language-bash"># Branch A New Feature Branch Off From Develop Branch
git checkout -b some-feature develop
# Add Feature Commits To Branch Some-feature ...
# Merge Feature Branch Back Into Develop Branch.
git checkout develop
git merge --no-ff some-feature
git push origin develop
</code></pre>

<h2 id="toc_3">2.2 release branches</h2>

<p>branch off from: <code>develop</code> branch</p>

<p>merge into: <code>develop</code> &amp; <code>master</code> branch</p>

<p>naming convention: <code>release/*</code> or <code>release-*</code></p>

<pre><code class="language-bash"># Branch A New Release Branch Off From Develop Branch
git checkout -b release-&lt;version number&gt; develop
# Bummp Up Version In Related Fiels.
git commit -m 'Bumped version number to &lt;version number&gt;'
# Roll Out Release, Minor Bug Fixes
# Merge The Release Into Master, And Give It A New Tag.
git checkout master
git merge --no-ff release-&lt;version number&gt;
git tag -a &lt;version number&gt;
# Merge The Release Back Into Develop
git checkout develop
git merge --no-ff release-&lt;version number&gt;
</code></pre>

<h2 id="toc_4">2.3 hotfix (or maintenance) branches</h2>

<p>branch off from: <code>master</code> branch
merge into: <code>develop</code> &amp; <code>master</code> branch if no active release branch existed
currrently.
naming convention: <code>hotfix/*</code> or <code>hotfix-*</code></p>

<pre><code class="language-bash"># Branch A New Hotfix Branch Off From Master Branch
git checkout -b hotfix-&lt;version number&gt; master
# Bummp Up Version In Related Fiels, Becuase It Will Finnaly Be Merged Back
# Into Master Branch.
git commit -m 'Bumped version number to &lt;version number&gt;'
# Roll Out Hotfix, Minor Bug Fixes
# Merge The Hotfix Into Master, And Give It A New Tag.
git checkout master
git merge --no-ff hotfix-&lt;version number&gt;
git tag -a &lt;version number&gt;
# Merge The Hotfix Back Into Develop
git checkout develop
git merge --no-ff hotfix-&lt;version number&gt;
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/go_stdlib_template/">
            GO&#39;S TEMPLATE LIBRARY
          </a>
        </h1>

        <span class="post-date">Fri, Sep 26, 2014</span>

        

<p>I come across this library when I started to use <a href="http://gohugo.io">Hugo</a>,
which says:</p>

<blockquote>
<p>It is an extremely <strong>lightweight</strong> engine that provides a very small amount of
logic. In our experience it is <strong>just the right amount of logic</strong> to be able to
create a good static website.</p>
</blockquote>

<h1 id="toc_0">3 Steps Using The Template Object</h1>

<ol>
<li><p><code>New</code> an template object.</p></li>

<li><p><code>Parse</code> template text.</p></li>

<li><p><code>Execute</code> (apply) the template to data structure.</p></li>
</ol>

<h1 id="toc_1">6 Action Families</h1>

<p><strong>comment</strong></p>

<pre><code class="language-go">{{/* comment here, line spanning allowed */}}
</code></pre>

<p><strong>pipeline</strong> like variable expansion (substitution)</p>

<pre><code class="language-go">{{pipeline}}
</code></pre>

<p><strong>if</strong> family for branching logic</p>

<pre><code class="language-go">{{if _pipline_}} T1 {{end}}
{{if _pipline_}} T1 {{else}} T0 {{end}}
{{if _pipline_}} T1 {{else if _pipeline_ }} T0 {{end}}

</code></pre>

<p><strong>range</strong> family for iteration (loop)</p>

<pre><code class="language-go">{{range pipepine}} T1 {{end}}
{{range pipepine}} T1 {{else}} T0 {{end}}

</code></pre>

<p><strong>with</strong> family for cursor (dot) moving</p>

<pre><code class="language-go">{{with pipeline}} T1 {{end}}
{{with pipeline}} T1 {{else}} T0 {{end}}

</code></pre>

<p><strong>template</strong> family for tempates invocation</p>

<pre><code class="language-go">// with the dot '.' set to nil.
{{tempalte &quot;name&quot;}}
// with the dot '.' set to value of 'pipeline'.
{{tempalte &quot;name&quot; pipeline}}

</code></pre>

<h1 id="toc_2">Argument Types</h1>

<ul>
<li><p>untyped <strong>constants</strong> in go syntax</p></li>

<li><p><strong>nil</strong> &ndash; the special constant</p></li>

<li><p><strong>variable</strong> name</p>

<p><code>$variable_name</code> or <code>$</code></p></li>

<li><p><code>.</code> &ndash; the so called &lsquo;context&rsquo; constant</p></li>

<li><p>dot chain consist of: <strong>field</strong> name,  <strong>key</strong> name,  niladic <strong>method</strong> name</p></li>
</ul>

<pre><code class="language-go">(.Field.Key.Method args...).Field.Key ...
</code></pre>

<ul>
<li><p>niladic <strong>function</strong> name</p></li>

<li><p>parenthesized <strong>group</strong> of above</p></li>
</ul>

<pre><code class="language-go">print (func arg...) (.method arg...)
</code></pre>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/ios_notes_cocoa_concurrency/">
            iOS NOTES - COCOA CONCURRENCY
          </a>
        </h1>

        <span class="post-date">Wed, Sep 24, 2014</span>

        

<h1 id="toc_0">Members Of Cocoa Concurrency</h1>

<ul>
<li><p>Operation Queue</p>

<ul>
<li><p>abstract base class <code>NSOperation</code></p></li>

<li><p>concrete subclass <code>NSInvocation</code></p></li>

<li><p>concrete subclass <code>NSBlockOperation</code></p></li>
</ul></li>

<li><p>Dispatch Queue</p></li>

<li><p>Dispatch Source</p></li>
</ul>

<h1 id="toc_1">Operation Queue Features</h1>

<ol>
<li><p>graph-based dependencies</p></li>

<li><p>completion block</p></li>

<li><p>execution status monitoring</p></li>

<li><p>prioritizeing</p></li>

<li><p>canceling</p></li>
</ol>

      </div>
      
      <div class="post">
        <h1 class="post-title">
          <a href="http://mudox.github.io/note/ios_notes_cocoa_threading/">
            iOS NOTES - COCOA THREADING
          </a>
        </h1>

        <span class="post-date">Wed, Sep 24, 2014</span>

        

<h1 id="toc_0">Run Loop</h1>

<h2 id="toc_1">4 roles participate in the run loop game:</h2>

<ol>
<li><p><strong>Run Loop</strong></p>

<p>which is represented by <code>NSRun Loop</code> &amp; <code>CFRunLoop</code>.</p></li>

<li><p><strong>Run Loop Mode</strong></p>

<p>which is represented by <code>CFStringRef</code> associated to each instance of run
loop object.</p></li>

<li><p><strong>Run Loop Source</strong></p>

<p>which is represented by <code>CFRunloopSource</code>.</p>

<ul>
<li><p>Input source</p>

<ul>
<li><p>Port-based source</p></li>

<li><p>Perform selctor on other threads</p></li>

<li><p>Custom source</p></li>
</ul></li>

<li><p>Timer</p>

<p>which is represented by <code>CFRunloopTimerRef</code>.</p>

<ul>
<li><p>Explictly defined timer</p></li>

<li><p>Perform selector on current thread with delay</p></li>

<li><p>Perform selector</p></li>
</ul></li>
</ul></li>

<li><p><strong>Run Loop Observer</strong></p></li>
</ol>

<h2 id="toc_2">4 ways to kill a run loop iteration:</h2>

<ol>
<li><p>no sources exists</p>

<p>since some system routines may install certain input sources to the run
 loop implictly, we should not kill a run loop iteration by clearing &lsquo;<em>all</em>&lsquo;
 sources we known.</p></li>

<li><p>timeout</p></li>

<li><p>sourced handled in one-shot mode</p></li>

<li><p>explicitly stoped by <code>CRunloopStop</code></p></li>
</ol>

<h2 id="toc_3">3 kinds of perform selector sources.</h2>

<table>
<thead>
<tr>
<th>on thread</th>
<th>invocation</th>
<th>delay</th>
<th>blocking call?</th>
<th>mode</th>
</tr>
</thead>

<tbody>
<tr>
<td>current thread</td>
<td>√</td>
<td>√</td>
<td>always non-blocking</td>
<td>√</td>
</tr>

<tr>
<td>other thread</td>
<td>√</td>
<td>x</td>
<td>√</td>
<td>x</td>
</tr>

<tr>
<td>main thread</td>
<td>√</td>
<td>x</td>
<td>√</td>
<td>x</td>
</tr>
</tbody>
</table>

<h1 id="toc_4">Alternatives To Threaing</h1>

<ol>
<li><p>Operation Objects</p></li>

<li><p>Grand Central Dispatch (GCD)</p></li>

<li><p>Idle-time notifications</p></li>

<li><p>Asynchronous functions</p></li>

<li><p>Timers</p></li>

<li><p>Separate processes</p></li>
</ol>

<h1 id="toc_5">Cocoa Support For Threading</h1>

<ol>
<li><p>Cocoa threads</p></li>

<li><p>POSIX threads</p></li>

<li><p><del>Mutiprocessing Services</del> (<em>obsolete</em>)</p></li>
</ol>

<h1 id="toc_6">Inter-Thread Communication</h1>

<ol>
<li><p>Direct messageing</p></li>

<li><p>Global variables, shared memory &amp; objects</p></li>

<li><p>Conditions</p></li>

<li><p>Run loop sources</p></li>

<li><p>Ports &amp; sockets</p></li>

<li><p><del>Message queues</del> (<em>obsolete</em>)</p></li>

<li><p>Cocoa distributed objects</p></li>
</ol>

<h1 id="toc_7">Synchronization Tools</h1>

<ol>
<li><p>Atomic operation</p>

<ul>
<li><p>atomic add</p></li>

<li><p>atomic increment</p></li>

<li><p>atomic decrement</p></li>

<li><p>compare-and-swap</p></li>

<li><p>test-and-set</p></li>

<li><p>test-and-clear</p></li>
</ul></li>

<li><p>Memory barriers</p></li>

<li><p>Volatile variables</p></li>

<li><p>Locks</p>

<ul>
<li><p>Mutex</p>

<ul>
<li><p>POSIX API provides <code>pthread_lock_t</code></p></li>

<li><p>Cocoa provides <code>NSLock</code> &amp;  <code>@synchronized()</code></p></li>
</ul></li>

<li><p>Recursive lock</p>

<p>which is provided as class <code>NSRecursiveLock</code></p></li>

<li><p>Read-write lock (<em>pthread only</em>)</p></li>

<li><p>Distributed lock</p></li>

<li><p>Spin lock (<em>not implemented</em>)</p></li>

<li><p>Double-checked lock</p></li>
</ul></li>

<li><p>Conditions (aka <em>condition variable</em>)</p></li>

<li><p>Perform selector routines</p></li>
</ol>

      </div>
      
    </div>
  </div>

      
    <script src="/lib/mudox.js"></script>
</body>
</html>

